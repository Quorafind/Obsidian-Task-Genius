/**
 * Badge Date Comparison Tests
 * Tests to verify moment date comparison issues in badge rendering
 */
import { moment } from "obsidian";
describe("Badge Date Comparison", () => {
    describe("Moment isSame comparison", () => {
        test("should compare dates correctly with different input types", () => {
            console.log("=== Date Comparison Debug ===");
            // Test different ways dates might be created
            const targetDate = new Date("2024-01-15T00:00:00.000Z");
            const eventDate1 = new Date("2024-01-15T10:00:00.000Z"); // Same day, different time
            const eventDate2 = new Date("2024-01-15T00:00:00.000Z"); // Exact same
            const eventDate3 = new Date("2024-01-16T00:00:00.000Z"); // Different day
            console.log("Target date:", targetDate.toISOString());
            console.log("Event date 1:", eventDate1.toISOString());
            console.log("Event date 2:", eventDate2.toISOString());
            console.log("Event date 3:", eventDate3.toISOString());
            // Test moment comparison
            const targetMoment = moment(targetDate).startOf("day");
            const eventMoment1 = moment(eventDate1).startOf("day");
            const eventMoment2 = moment(eventDate2).startOf("day");
            const eventMoment3 = moment(eventDate3).startOf("day");
            console.log("\nMoment objects:");
            console.log("Target moment:", targetMoment.format("YYYY-MM-DD"));
            console.log("Event moment 1:", eventMoment1.format("YYYY-MM-DD"));
            console.log("Event moment 2:", eventMoment2.format("YYYY-MM-DD"));
            console.log("Event moment 3:", eventMoment3.format("YYYY-MM-DD"));
            // Test isSame
            const isSame1 = eventMoment1.isSame(targetMoment);
            const isSame2 = eventMoment2.isSame(targetMoment);
            const isSame3 = eventMoment3.isSame(targetMoment);
            console.log("\nisSame results:");
            console.log("Event 1 isSame target:", isSame1);
            console.log("Event 2 isSame target:", isSame2);
            console.log("Event 3 isSame target:", isSame3);
            // Test with 'day' unit
            const isSameDay1 = eventMoment1.isSame(targetMoment, "day");
            const isSameDay2 = eventMoment2.isSame(targetMoment, "day");
            const isSameDay3 = eventMoment3.isSame(targetMoment, "day");
            console.log("\nisSame with 'day' unit:");
            console.log("Event 1 isSame target (day):", isSameDay1);
            console.log("Event 2 isSame target (day):", isSameDay2);
            console.log("Event 3 isSame target (day):", isSameDay3);
            // Assertions
            expect(isSame1).toBe(true); // Same day after startOf('day')
            expect(isSame2).toBe(true); // Same day
            expect(isSame3).toBe(false); // Different day
            expect(isSameDay1).toBe(true);
            expect(isSameDay2).toBe(true);
            expect(isSameDay3).toBe(false);
        });
        test("should handle timezone issues correctly", () => {
            console.log("\n=== Timezone Comparison Debug ===");
            // Simulate potential timezone issues
            const utcDate = new Date("2024-01-15T10:00:00.000Z");
            const localDate = new Date("2024-01-15T10:00:00"); // No Z, local time
            console.log("UTC date:", utcDate.toISOString());
            console.log("Local date:", localDate.toISOString());
            console.log("UTC date local string:", utcDate.toString());
            console.log("Local date local string:", localDate.toString());
            const utcMoment = moment(utcDate).startOf("day");
            const localMoment = moment(localDate).startOf("day");
            const targetMoment = moment(new Date("2024-01-15")).startOf("day");
            console.log("\nMoment formats:");
            console.log("UTC moment:", utcMoment.format("YYYY-MM-DD HH:mm:ss"));
            console.log("Local moment:", localMoment.format("YYYY-MM-DD HH:mm:ss"));
            console.log("Target moment:", targetMoment.format("YYYY-MM-DD HH:mm:ss"));
            const utcSame = utcMoment.isSame(targetMoment, "day");
            const localSame = localMoment.isSame(targetMoment, "day");
            console.log("\nComparison results:");
            console.log("UTC same as target:", utcSame);
            console.log("Local same as target:", localSame);
            // Both should be true for the same day
            expect(utcSame).toBe(true);
            expect(localSame).toBe(true);
        });
        test("should debug actual badge comparison scenario", () => {
            console.log("\n=== Actual Badge Scenario Debug ===");
            // Simulate the actual scenario from getBadgeEventsForDate
            const inputDate = new Date("2024-01-15"); // Date passed to getBadgeEventsForDate
            const icsEventDate = new Date("2024-01-15T10:00:00Z"); // ICS event dtstart
            console.log("Input date:", inputDate.toISOString());
            console.log("ICS event date:", icsEventDate.toISOString());
            // This is what happens in getBadgeEventsForDate
            const targetDate = moment(inputDate).startOf("day");
            const eventDate = moment(icsEventDate).startOf("day");
            console.log("Target date moment:", targetDate.format("YYYY-MM-DD HH:mm:ss"));
            console.log("Event date moment:", eventDate.format("YYYY-MM-DD HH:mm:ss"));
            // Test the comparison
            const isSameResult = eventDate.isSame(targetDate);
            const isSameDayResult = eventDate.isSame(targetDate, "day");
            console.log("isSame result:", isSameResult);
            console.log("isSame with 'day' unit:", isSameDayResult);
            // Debug internal values
            console.log("\nInternal debug:");
            console.log("Target date valueOf:", targetDate.valueOf());
            console.log("Event date valueOf:", eventDate.valueOf());
            console.log("Target date _date:", targetDate._date);
            console.log("Event date _date:", eventDate._date);
            // This should be true
            expect(isSameResult).toBe(true);
            expect(isSameDayResult).toBe(true);
        });
        test("should test edge cases with different date formats", () => {
            console.log("\n=== Edge Cases Debug ===");
            // Test various date input formats
            const testCases = [
                {
                    name: "String date",
                    target: "2024-01-15",
                    event: "2024-01-15T10:00:00Z",
                },
                {
                    name: "Timestamp",
                    target: new Date("2024-01-15").getTime(),
                    event: new Date("2024-01-15T10:00:00Z").getTime(),
                },
                {
                    name: "Date objects",
                    target: new Date("2024-01-15"),
                    event: new Date("2024-01-15T10:00:00Z"),
                },
            ];
            testCases.forEach((testCase, index) => {
                console.log(`\nTest case ${index + 1}: ${testCase.name}`);
                console.log("Target:", testCase.target);
                console.log("Event:", testCase.event);
                const targetMoment = moment(testCase.target).startOf("day");
                const eventMoment = moment(testCase.event).startOf("day");
                console.log("Target moment:", targetMoment.format("YYYY-MM-DD HH:mm:ss"));
                console.log("Event moment:", eventMoment.format("YYYY-MM-DD HH:mm:ss"));
                const isSame = eventMoment.isSame(targetMoment);
                console.log("isSame result:", isSame);
                expect(isSame).toBe(true);
            });
        });
        test("should identify the specific issue with mock moment", () => {
            console.log("\n=== Mock Moment Issue Debug ===");
            // Test the exact scenario that might be failing
            const date = new Date("2024-01-15");
            const icsEventDtstart = new Date("2024-01-15T10:00:00Z");
            console.log("Original dates:");
            console.log("Date:", date);
            console.log("ICS event dtstart:", icsEventDtstart);
            // Create moments like in the actual code
            const targetDate = moment(date).startOf("day");
            const eventDate = moment(icsEventDtstart).startOf("day");
            console.log("\nMoment objects:");
            console.log("Target date:", targetDate);
            console.log("Event date:", eventDate);
            // Check internal structure
            console.log("\nInternal structure:");
            console.log("Target date _date:", targetDate._date);
            console.log("Event date _date:", eventDate._date);
            // Test the comparison
            const result = eventDate.isSame(targetDate);
            console.log("\nComparison result:", result);
            // Manual comparison for debugging
            if (targetDate._date && eventDate._date) {
                const targetDateStr = targetDate._date
                    .toISOString()
                    .split("T")[0];
                const eventDateStr = eventDate._date
                    .toISOString()
                    .split("T")[0];
                console.log("Manual string comparison:");
                console.log("Target date string:", targetDateStr);
                console.log("Event date string:", eventDateStr);
                console.log("Strings equal:", targetDateStr === eventDateStr);
            }
            expect(result).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFkZ2UtZGF0ZS1jb21wYXJpc29uLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJiYWRnZS1kYXRlLWNvbXBhcmlzb24udGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0dBR0c7QUFFSCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRWxDLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7SUFDdEMsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtRQUN6QyxJQUFJLENBQUMsMkRBQTJELEVBQUUsR0FBRyxFQUFFO1lBQ3RFLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQztZQUU3Qyw2Q0FBNkM7WUFDN0MsTUFBTSxVQUFVLEdBQUcsSUFBSSxJQUFJLENBQUMsMEJBQTBCLENBQUMsQ0FBQztZQUN4RCxNQUFNLFVBQVUsR0FBRyxJQUFJLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLENBQUMsMkJBQTJCO1lBQ3BGLE1BQU0sVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxhQUFhO1lBQ3RFLE1BQU0sVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7WUFFekUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFDdEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFDdkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFDdkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFFdkQseUJBQXlCO1lBQ3pCLE1BQU0sWUFBWSxHQUFH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Q2xELE9BQU8sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLEVBQUUsWUFBWSxDQUFDLENBQUM7Z0JBQ2hELE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsYUFBYSxLQUFLLFlBQVksQ0FBQyxDQUFDO2FBQzlEO1lBRUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQixDQUFDLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQmFkZ2UgRGF0ZSBDb21wYXJpc29uIFRlc3RzXHJcbiAqIFRlc3RzIHRvIHZlcmlmeSBtb21lbnQgZGF0ZSBjb21wYXJpc29uIGlzc3VlcyBpbiBiYWRnZSByZW5kZXJpbmdcclxuICovXHJcblxyXG5pbXBvcnQgeyBtb21lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmRlc2NyaWJlKFwiQmFkZ2UgRGF0ZSBDb21wYXJpc29uXCIsICgpID0+IHtcclxuXHRkZXNjcmliZShcIk1vbWVudCBpc1NhbWUgY29tcGFyaXNvblwiLCAoKSA9PiB7XHJcblx0XHR0ZXN0KFwic2hvdWxkIGNvbXBhcmUgZGF0ZXMgY29ycmVjdGx5IHdpdGggZGlmZmVyZW50IGlucHV0IHR5cGVzXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc29sZS5sb2coXCI9PT0gRGF0ZSBDb21wYXJpc29uIERlYnVnID09PVwiKTtcclxuXHJcblx0XHRcdC8vIFRlc3QgZGlmZmVyZW50IHdheXMgZGF0ZXMgbWlnaHQgYmUgY3JlYXRlZFxyXG5cdFx0XHRjb25zdCB0YXJnZXREYXRlID0gbmV3IERhdGUoXCIyMDI0LTAxLTE1VDAwOjAwOjAwLjAwMFpcIik7XHJcblx0XHRcdGNvbnN0IGV2ZW50RGF0ZTEgPSBuZXcgRGF0ZShcIjIwMjQtMDEtMTVUMTA6MDA6MDAuMDAwWlwiKTsgLy8gU2FtZSBkYXksIGRpZmZlcmVudCB0aW1lXHJcblx0XHRcdGNvbnN0IGV2ZW50RGF0ZTIgPSBuZXcgRGF0ZShcIjIwMjQtMDEtMTVUMDA6MDA6MDAuMDAwWlwiKTsgLy8gRXhhY3Qgc2FtZVxyXG5cdFx0XHRjb25zdCBldmVudERhdGUzID0gbmV3IERhdGUoXCIyMDI0LTAxLTE2VDAwOjAwOjAwLjAwMFpcIik7IC8vIERpZmZlcmVudCBkYXlcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVGFyZ2V0IGRhdGU6XCIsIHRhcmdldERhdGUudG9JU09TdHJpbmcoKSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgZGF0ZSAxOlwiLCBldmVudERhdGUxLnRvSVNPU3RyaW5nKCkpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IGRhdGUgMjpcIiwgZXZlbnREYXRlMi50b0lTT1N0cmluZygpKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCBkYXRlIDM6XCIsIGV2ZW50RGF0ZTMudG9JU09TdHJpbmcoKSk7XHJcblxyXG5cdFx0XHQvLyBUZXN0IG1vbWVudCBjb21wYXJpc29uXHJcblx0XHRcdGNvbnN0IHRhcmdldE1vbWVudCA9IG1vbWVudCh0YXJnZXREYXRlKS5zdGFydE9mKFwiZGF5XCIpO1xyXG5cdFx0XHRjb25zdCBldmVudE1vbWVudDEgPSBtb21lbnQoZXZlbnREYXRlMSkuc3RhcnRPZihcImRheVwiKTtcclxuXHRcdFx0Y29uc3QgZXZlbnRNb21lbnQyID0gbW9tZW50KGV2ZW50RGF0ZTIpLnN0YXJ0T2YoXCJkYXlcIik7XHJcblx0XHRcdGNvbnN0IGV2ZW50TW9tZW50MyA9IG1vbWVudChldmVudERhdGUzKS5zdGFydE9mKFwiZGF5XCIpO1xyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXG5Nb21lbnQgb2JqZWN0czpcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVGFyZ2V0IG1vbWVudDpcIiwgdGFyZ2V0TW9tZW50LmZvcm1hdChcIllZWVktTU0tRERcIikpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IG1vbWVudCAxOlwiLCBldmVudE1vbWVudDEuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgbW9tZW50IDI6XCIsIGV2ZW50TW9tZW50Mi5mb3JtYXQoXCJZWVlZLU1NLUREXCIpKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCBtb21lbnQgMzpcIiwgZXZlbnRNb21lbnQzLmZvcm1hdChcIllZWVktTU0tRERcIikpO1xyXG5cclxuXHRcdFx0Ly8gVGVzdCBpc1NhbWVcclxuXHRcdFx0Y29uc3QgaXNTYW1lMSA9IGV2ZW50TW9tZW50MS5pc1NhbWUodGFyZ2V0TW9tZW50KTtcclxuXHRcdFx0Y29uc3QgaXNTYW1lMiA9IGV2ZW50TW9tZW50Mi5pc1NhbWUodGFyZ2V0TW9tZW50KTtcclxuXHRcdFx0Y29uc3QgaXNTYW1lMyA9IGV2ZW50TW9tZW50My5pc1NhbWUodGFyZ2V0TW9tZW50KTtcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiXFxuaXNTYW1lIHJlc3VsdHM6XCIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IDEgaXNTYW1lIHRhcmdldDpcIiwgaXNTYW1lMSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgMiBpc1NhbWUgdGFyZ2V0OlwiLCBpc1NhbWUyKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCAzIGlzU2FtZSB0YXJnZXQ6XCIsIGlzU2FtZTMpO1xyXG5cclxuXHRcdFx0Ly8gVGVzdCB3aXRoICdkYXknIHVuaXRcclxuXHRcdFx0Y29uc3QgaXNTYW1lRGF5MSA9IGV2ZW50TW9tZW50MS5pc1NhbWUodGFyZ2V0TW9tZW50LCBcImRheVwiKTtcclxuXHRcdFx0Y29uc3QgaXNTYW1lRGF5MiA9IGV2ZW50TW9tZW50Mi5pc1NhbWUodGFyZ2V0TW9tZW50LCBcImRheVwiKTtcclxuXHRcdFx0Y29uc3QgaXNTYW1lRGF5MyA9IGV2ZW50TW9tZW50My5pc1NhbWUodGFyZ2V0TW9tZW50LCBcImRheVwiKTtcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiXFxuaXNTYW1lIHdpdGggJ2RheScgdW5pdDpcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgMSBpc1NhbWUgdGFyZ2V0IChkYXkpOlwiLCBpc1NhbWVEYXkxKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCAyIGlzU2FtZSB0YXJnZXQgKGRheSk6XCIsIGlzU2FtZURheTIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IDMgaXNTYW1lIHRhcmdldCAoZGF5KTpcIiwgaXNTYW1lRGF5Myk7XHJcblxyXG5cdFx0XHQvLyBBc3NlcnRpb25zXHJcblx0XHRcdGV4cGVjdChpc1NhbWUxKS50b0JlKHRydWUpOyAvLyBTYW1lIGRheSBhZnRlciBzdGFydE9mKCdkYXknKVxyXG5cdFx0XHRleHBlY3QoaXNTYW1lMikudG9CZSh0cnVlKTsgLy8gU2FtZSBkYXlcclxuXHRcdFx0ZXhwZWN0KGlzU2FtZTMpLnRvQmUoZmFsc2UpOyAvLyBEaWZmZXJlbnQgZGF5XHJcblxyXG5cdFx0XHRleHBlY3QoaXNTYW1lRGF5MSkudG9CZSh0cnVlKTtcclxuXHRcdFx0ZXhwZWN0KGlzU2FtZURheTIpLnRvQmUodHJ1ZSk7XHJcblx0XHRcdGV4cGVjdChpc1NhbWVEYXkzKS50b0JlKGZhbHNlKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgaGFuZGxlIHRpbWV6b25lIGlzc3VlcyBjb3JyZWN0bHlcIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlxcbj09PSBUaW1lem9uZSBDb21wYXJpc29uIERlYnVnID09PVwiKTtcclxuXHJcblx0XHRcdC8vIFNpbXVsYXRlIHBvdGVudGlhbCB0aW1lem9uZSBpc3N1ZXNcclxuXHRcdFx0Y29uc3QgdXRjRGF0ZSA9IG5ldyBEYXRlKFwiMjAyNC0wMS0xNVQxMDowMDowMC4wMDBaXCIpO1xyXG5cdFx0XHRjb25zdCBsb2NhbERhdGUgPSBuZXcgRGF0ZShcIjIwMjQtMDEtMTVUMTA6MDA6MDBcIik7IC8vIE5vIFosIGxvY2FsIHRpbWVcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVVRDIGRhdGU6XCIsIHV0Y0RhdGUudG9JU09TdHJpbmcoKSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiTG9jYWwgZGF0ZTpcIiwgbG9jYWxEYXRlLnRvSVNPU3RyaW5nKCkpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlVUQyBkYXRlIGxvY2FsIHN0cmluZzpcIiwgdXRjRGF0ZS50b1N0cmluZygpKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJMb2NhbCBkYXRlIGxvY2FsIHN0cmluZzpcIiwgbG9jYWxEYXRlLnRvU3RyaW5nKCkpO1xyXG5cclxuXHRcdFx0Y29uc3QgdXRjTW9tZW50ID0gbW9tZW50KHV0Y0RhdGUpLnN0YXJ0T2YoXCJkYXlcIik7XHJcblx0XHRcdGNvbnN0IGxvY2FsTW9tZW50ID0gbW9tZW50KGxvY2FsRGF0ZSkuc3RhcnRPZihcImRheVwiKTtcclxuXHRcdFx0Y29uc3QgdGFyZ2V0TW9tZW50ID0gbW9tZW50KG5ldyBEYXRlKFwiMjAyNC0wMS0xNVwiKSkuc3RhcnRPZihcImRheVwiKTtcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiXFxuTW9tZW50IGZvcm1hdHM6XCIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlVUQyBtb21lbnQ6XCIsIHV0Y01vbWVudC5mb3JtYXQoXCJZWVlZLU1NLUREIEhIOm1tOnNzXCIpKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXHJcblx0XHRcdFx0XCJMb2NhbCBtb21lbnQ6XCIsXHJcblx0XHRcdFx0bG9jYWxNb21lbnQuZm9ybWF0KFwiWVlZWS1NTS1ERCBISDptbTpzc1wiKVxyXG5cdFx0XHQpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcclxuXHRcdFx0XHRcIlRhcmdldCBtb21lbnQ6XCIsXHJcblx0XHRcdFx0dGFyZ2V0TW9tZW50LmZvcm1hdChcIllZWVktTU0tREQgSEg6bW06c3NcIilcclxuXHRcdFx0KTtcclxuXHJcblx0XHRcdGNvbnN0IHV0Y1NhbWUgPSB1dGNNb21lbnQuaXNTYW1lKHRhcmdldE1vbWVudCwgXCJkYXlcIik7XHJcblx0XHRcdGNvbnN0IGxvY2FsU2FtZSA9IGxvY2FsTW9tZW50LmlzU2FtZSh0YXJnZXRNb21lbnQsIFwiZGF5XCIpO1xyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXG5Db21wYXJpc29uIHJlc3VsdHM6XCIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlVUQyBzYW1lIGFzIHRhcmdldDpcIiwgdXRjU2FtZSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiTG9jYWwgc2FtZSBhcyB0YXJnZXQ6XCIsIGxvY2FsU2FtZSk7XHJcblxyXG5cdFx0XHQvLyBCb3RoIHNob3VsZCBiZSB0cnVlIGZvciB0aGUgc2FtZSBkYXlcclxuXHRcdFx0ZXhwZWN0KHV0Y1NhbWUpLnRvQmUodHJ1ZSk7XHJcblx0XHRcdGV4cGVjdChsb2NhbFNhbWUpLnRvQmUodHJ1ZSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHR0ZXN0KFwic2hvdWxkIGRlYnVnIGFjdHVhbCBiYWRnZSBjb21wYXJpc29uIHNjZW5hcmlvXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXG49PT0gQWN0dWFsIEJhZGdlIFNjZW5hcmlvIERlYnVnID09PVwiKTtcclxuXHJcblx0XHRcdC8vIFNpbXVsYXRlIHRoZSBhY3R1YWwgc2NlbmFyaW8gZnJvbSBnZXRCYWRnZUV2ZW50c0ZvckRhdGVcclxuXHRcdFx0Y29uc3QgaW5wdXREYXRlID0gbmV3IERhdGUoXCIyMDI0LTAxLTE1XCIpOyAvLyBEYXRlIHBhc3NlZCB0byBnZXRCYWRnZUV2ZW50c0ZvckRhdGVcclxuXHRcdFx0Y29uc3QgaWNzRXZlbnREYXRlID0gbmV3IERhdGUoXCIyMDI0LTAxLTE1VDEwOjAwOjAwWlwiKTsgLy8gSUNTIGV2ZW50IGR0c3RhcnRcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiSW5wdXQgZGF0ZTpcIiwgaW5wdXREYXRlLnRvSVNPU3RyaW5nKCkpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIklDUyBldmVudCBkYXRlOlwiLCBpY3NFdmVudERhdGUudG9JU09TdHJpbmcoKSk7XHJcblxyXG5cdFx0XHQvLyBUaGlzIGlzIHdoYXQgaGFwcGVucyBpbiBnZXRCYWRnZUV2ZW50c0ZvckRhdGVcclxuXHRcdFx0Y29uc3QgdGFyZ2V0RGF0ZSA9IG1vbWVudChpbnB1dERhdGUpLnN0YXJ0T2YoXCJkYXlcIik7XHJcblx0XHRcdGNvbnN0IGV2ZW50RGF0ZSA9IG1vbWVudChpY3NFdmVudERhdGUpLnN0YXJ0T2YoXCJkYXlcIik7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcclxuXHRcdFx0XHRcIlRhcmdldCBkYXRlIG1vbWVudDpcIixcclxuXHRcdFx0XHR0YXJnZXREYXRlLmZvcm1hdChcIllZWVktTU0tREQgSEg6bW06c3NcIilcclxuXHRcdFx0KTtcclxuXHRcdFx0Y29uc29sZS5sb2coXHJcblx0XHRcdFx0XCJFdmVudCBkYXRlIG1vbWVudDpcIixcclxuXHRcdFx0XHRldmVudERhdGUuZm9ybWF0KFwiWVlZWS1NTS1ERCBISDptbTpzc1wiKVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0Ly8gVGVzdCB0aGUgY29tcGFyaXNvblxyXG5cdFx0XHRjb25zdCBpc1NhbWVSZXN1bHQgPSBldmVudERhdGUuaXNTYW1lKHRhcmdldERhdGUpO1xyXG5cdFx0XHRjb25zdCBpc1NhbWVEYXlSZXN1bHQgPSBldmVudERhdGUuaXNTYW1lKHRhcmdldERhdGUsIFwiZGF5XCIpO1xyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCJpc1NhbWUgcmVzdWx0OlwiLCBpc1NhbWVSZXN1bHQpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcImlzU2FtZSB3aXRoICdkYXknIHVuaXQ6XCIsIGlzU2FtZURheVJlc3VsdCk7XHJcblxyXG5cdFx0XHQvLyBEZWJ1ZyBpbnRlcm5hbCB2YWx1ZXNcclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXG5JbnRlcm5hbCBkZWJ1ZzpcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVGFyZ2V0IGRhdGUgdmFsdWVPZjpcIiwgdGFyZ2V0RGF0ZS52YWx1ZU9mKCkpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IGRhdGUgdmFsdWVPZjpcIiwgZXZlbnREYXRlLnZhbHVlT2YoKSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVGFyZ2V0IGRhdGUgX2RhdGU6XCIsICh0YXJnZXREYXRlIGFzIGFueSkuX2RhdGUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IGRhdGUgX2RhdGU6XCIsIChldmVudERhdGUgYXMgYW55KS5fZGF0ZSk7XHJcblxyXG5cdFx0XHQvLyBUaGlzIHNob3VsZCBiZSB0cnVlXHJcblx0XHRcdGV4cGVjdChpc1NhbWVSZXN1bHQpLnRvQmUodHJ1ZSk7XHJcblx0XHRcdGV4cGVjdChpc1NhbWVEYXlSZXN1bHQpLnRvQmUodHJ1ZSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHR0ZXN0KFwic2hvdWxkIHRlc3QgZWRnZSBjYXNlcyB3aXRoIGRpZmZlcmVudCBkYXRlIGZvcm1hdHNcIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlxcbj09PSBFZGdlIENhc2VzIERlYnVnID09PVwiKTtcclxuXHJcblx0XHRcdC8vIFRlc3QgdmFyaW91cyBkYXRlIGlucHV0IGZvcm1hdHNcclxuXHRcdFx0Y29uc3QgdGVzdENhc2VzID0gW1xyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdG5hbWU6IFwiU3RyaW5nIGRhdGVcIixcclxuXHRcdFx0XHRcdHRhcmdldDogXCIyMDI0LTAxLTE1XCIsXHJcblx0XHRcdFx0XHRldmVudDogXCIyMDI0LTAxLTE1VDEwOjAwOjAwWlwiLFxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0bmFtZTogXCJUaW1lc3RhbXBcIixcclxuXHRcdFx0XHRcdHRhcmdldDogbmV3IERhdGUoXCIyMDI0LTAxLTE1XCIpLmdldFRpbWUoKSxcclxuXHRcdFx0XHRcdGV2ZW50OiBuZXcgRGF0ZShcIjIwMjQtMDEtMTVUMTA6MDA6MDBaXCIpLmdldFRpbWUoKSxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdG5hbWU6IFwiRGF0ZSBvYmplY3RzXCIsXHJcblx0XHRcdFx0XHR0YXJnZXQ6IG5ldyBEYXRlKFwiMjAyNC0wMS0xNVwiKSxcclxuXHRcdFx0XHRcdGV2ZW50OiBuZXcgRGF0ZShcIjIwMjQtMDEtMTVUMTA6MDA6MDBaXCIpLFxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdF07XHJcblxyXG5cdFx0XHR0ZXN0Q2FzZXMuZm9yRWFjaCgodGVzdENhc2UsIGluZGV4KSA9PiB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coYFxcblRlc3QgY2FzZSAke2luZGV4ICsgMX06ICR7dGVzdENhc2UubmFtZX1gKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlRhcmdldDpcIiwgdGVzdENhc2UudGFyZ2V0KTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50OlwiLCB0ZXN0Q2FzZS5ldmVudCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IHRhcmdldE1vbWVudCA9IG1vbWVudCh0ZXN0Q2FzZS50YXJnZXQpLnN0YXJ0T2YoXCJkYXlcIik7XHJcblx0XHRcdFx0Y29uc3QgZXZlbnRNb21lbnQgPSBtb21lbnQodGVzdENhc2UuZXZlbnQpLnN0YXJ0T2YoXCJkYXlcIik7XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFxyXG5cdFx0XHRcdFx0XCJUYXJnZXQgbW9tZW50OlwiLFxyXG5cdFx0XHRcdFx0dGFyZ2V0TW9tZW50LmZvcm1hdChcIllZWVktTU0tREQgSEg6bW06c3NcIilcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFxyXG5cdFx0XHRcdFx0XCJFdmVudCBtb21lbnQ6XCIsXHJcblx0XHRcdFx0XHRldmVudE1vbWVudC5mb3JtYXQoXCJZWVlZLU1NLUREIEhIOm1tOnNzXCIpXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdFx0Y29uc3QgaXNTYW1lID0gZXZlbnRNb21lbnQuaXNTYW1lKHRhcmdldE1vbWVudCk7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJpc1NhbWUgcmVzdWx0OlwiLCBpc1NhbWUpO1xyXG5cclxuXHRcdFx0XHRleHBlY3QoaXNTYW1lKS50b0JlKHRydWUpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgaWRlbnRpZnkgdGhlIHNwZWNpZmljIGlzc3VlIHdpdGggbW9jayBtb21lbnRcIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlxcbj09PSBNb2NrIE1vbWVudCBJc3N1ZSBEZWJ1ZyA9PT1cIik7XHJcblxyXG5cdFx0XHQvLyBUZXN0IHRoZSBleGFjdCBzY2VuYXJpbyB0aGF0IG1pZ2h0IGJlIGZhaWxpbmdcclxuXHRcdFx0Y29uc3QgZGF0ZSA9IG5ldyBEYXRlKFwiMjAyNC0wMS0xNVwiKTtcclxuXHRcdFx0Y29uc3QgaWNzRXZlbnREdHN0YXJ0ID0gbmV3IERhdGUoXCIyMDI0LTAxLTE1VDEwOjAwOjAwWlwiKTtcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiT3JpZ2luYWwgZGF0ZXM6XCIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkRhdGU6XCIsIGRhdGUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIklDUyBldmVudCBkdHN0YXJ0OlwiLCBpY3NFdmVudER0c3RhcnQpO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRlIG1vbWVudHMgbGlrZSBpbiB0aGUgYWN0dWFsIGNvZGVcclxuXHRcdFx0Y29uc3QgdGFyZ2V0RGF0ZSA9IG1vbWVudChkYXRlKS5zdGFydE9mKFwiZGF5XCIpO1xyXG5cdFx0XHRjb25zdCBldmVudERhdGUgPSBtb21lbnQoaWNzRXZlbnREdHN0YXJ0KS5zdGFydE9mKFwiZGF5XCIpO1xyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXG5Nb21lbnQgb2JqZWN0czpcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVGFyZ2V0IGRhdGU6XCIsIHRhcmdldERhdGUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50IGRhdGU6XCIsIGV2ZW50RGF0ZSk7XHJcblxyXG5cdFx0XHQvLyBDaGVjayBpbnRlcm5hbCBzdHJ1Y3R1cmVcclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXG5JbnRlcm5hbCBzdHJ1Y3R1cmU6XCIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlRhcmdldCBkYXRlIF9kYXRlOlwiLCAodGFyZ2V0RGF0ZSBhcyBhbnkpLl9kYXRlKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCBkYXRlIF9kYXRlOlwiLCAoZXZlbnREYXRlIGFzIGFueSkuX2RhdGUpO1xyXG5cclxuXHRcdFx0Ly8gVGVzdCB0aGUgY29tcGFyaXNvblxyXG5cdFx0XHRjb25zdCByZXN1bHQgPSBldmVudERhdGUuaXNTYW1lKHRhcmdldERhdGUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlxcbkNvbXBhcmlzb24gcmVzdWx0OlwiLCByZXN1bHQpO1xyXG5cclxuXHRcdFx0Ly8gTWFudWFsIGNvbXBhcmlzb24gZm9yIGRlYnVnZ2luZ1xyXG5cdFx0XHRpZiAoKHRhcmdldERhdGUgYXMgYW55KS5fZGF0ZSAmJiAoZXZlbnREYXRlIGFzIGFueSkuX2RhdGUpIHtcclxuXHRcdFx0XHRjb25zdCB0YXJnZXREYXRlU3RyID0gKHRhcmdldERhdGUgYXMgYW55KS5fZGF0ZVxyXG5cdFx0XHRcdFx0LnRvSVNPU3RyaW5nKClcclxuXHRcdFx0XHRcdC5zcGxpdChcIlRcIilbMF07XHJcblx0XHRcdFx0Y29uc3QgZXZlbnREYXRlU3RyID0gKGV2ZW50RGF0ZSBhcyBhbnkpLl9kYXRlXHJcblx0XHRcdFx0XHQudG9JU09TdHJpbmcoKVxyXG5cdFx0XHRcdFx0LnNwbGl0KFwiVFwiKVswXTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIk1hbnVhbCBzdHJpbmcgY29tcGFyaXNvbjpcIik7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJUYXJnZXQgZGF0ZSBzdHJpbmc6XCIsIHRhcmdldERhdGVTdHIpO1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgZGF0ZSBzdHJpbmc6XCIsIGV2ZW50RGF0ZVN0cik7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJTdHJpbmdzIGVxdWFsOlwiLCB0YXJnZXREYXRlU3RyID09PSBldmVudERhdGVTdHIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0pO1xyXG4iXX0=