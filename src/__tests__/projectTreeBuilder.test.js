/**
 * Tests for project tree builder utilities
 */
import { parseProjectPath, buildProjectTree, buildProjectTreeFromTasks, findNodeByPath, getAllDescendants, getExpandedPaths, restoreExpandedState } from '../core/project-tree-builder';
describe('parseProjectPath', () => {
    it('should parse simple project path', () => {
        const result = parseProjectPath('Project/SubProject');
        expect(result).toEqual(['Project', 'SubProject']);
    });
    it('should handle custom separator', () => {
        const result = parseProjectPath('Project::SubProject', '::');
        expect(result).toEqual(['Project', 'SubProject']);
    });
    it('should handle empty path', () => {
        const result = parseProjectPath('');
        expect(result).toEqual([]);
    });
    it('should trim whitespace', () => {
        const result = parseProjectPath('  Project/SubProject  ');
        expect(result).toEqual(['Project', 'SubProject']);
    });
    it('should handle duplicate separators', () => {
        const result = parseProjectPath('Project//SubProject///Task');
        expect(result).toEqual(['Project', 'SubProject', 'Task']);
    });
    it('should handle leading and trailing separators', () => {
        const result = parseProjectPath('/Project/SubProject/');
        expect(result).toEqual(['Project', 'SubProject']);
    });
});
describe('buildProjectTree', () => {
    it('should build tree from flat project map', () => {
        const projectsMap = new Map([
            ['Project A', new Set(['task1', 'task2'])],
            ['Project A/SubProject 1', new Set(['task3'])],
            ['Project A/SubProject 2', new Set(['task4', 'task5'])],
            ['Project B', new Set(['task6'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        expect(tree.id).toBe('root');
        expect(tree.children.length).toBe(2);
        const projectA = tree.children.find(n => n.name === 'Project A');
        expect(projectA).toBeDefined();
        expect(projectA.children.length).toBe(2);
        expect(projectA.data.directTaskCount).toBe(2);
        expect(projectA.data.totalTaskCount).toBe(5);
        const subProject1 = projectA.children.find(n => n.name === 'SubProject 1');
        expect(subProject1).toBeDefined();
        expect(subProject1.data.directTaskCount).toBe(1);
        expect(subProject1.data.totalTaskCount).toBe(1);
    });
    it('should handle single level projects', () => {
        const projectsMap = new Map([
            ['Project A', new Set(['task1', 'task2'])],
            ['Project B', new Set(['task3'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        expect(tree.children.length).toBe(2);
        expect(tree.children[0].children.length).toBe(0);
        expect(tree.children[1].children.length).toBe(0);
    });
    it('should handle deep nesting', () => {
        const projectsMap = new Map([
            ['A/B/C/D', new Set(['task1'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        let current = tree;
        const expectedNames = ['A', 'B', 'C', 'D'];
        for (const name of expectedNames) {
            expect(current.children.length).toBe(1);
            current = current.children[0];
            expect(current.name).toBe(name);
        }
        expect(current.children.length).toBe(0);
    });
    it('should sort children alphabetically', () => {
        const projectsMap = new Map([
            ['Zebra', new Set(['task1'])],
            ['Apple', new Set(['task2'])],
            ['Banana', new Set(['task3'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        expect(tree.children[0].name).toBe('Apple');
        expect(tree.children[1].name).toBe('Banana');
        expect(tree.children[2].name).toBe('Zebra');
    });
    it('should calculate cumulative task counts correctly', () => {
        const projectsMap = new Map([
            ['Parent', new Set(['task1', 'task2'])],
            ['Parent/Child1', new Set(['task3', 'task4'])],
            ['Parent/Child1/GrandChild', new Set(['task5'])],
            ['Parent/Child2', new Set(['task6'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        const parent = tree.children[0];
        expect(parent.data.directTaskCount).toBe(2);
        expect(parent.data.totalTaskCount).toBe(6);
        const child1 = parent.children.find(n => n.name === 'Child1');
        expect(child1.data.directTaskCount).toBe(2);
        expect(child1.data.totalTaskCount).toBe(3);
    });
});
describe('buildProjectTreeFromTasks', () => {
    it('should build tree from task list', () => {
        const tasks = [
            {
                id: 'task1',
                content: 'Task 1',
                filePath: 'file1.md',
                line: 1,
                completed: false,
                status: ' ',
                originalMarkdown: '- [ ] Task 1',
                metadata: {
                    project: 'Project A/SubProject 1',
                    tags: [],
                    children: []
                }
            },
            {
                id: 'task2',
                content: 'Task 2',
                filePath: 'file2.md',
                line: 1,
                completed: false,
                status: ' ',
                originalMarkdown: '- [ ] Task 2',
                metadata: {
                    project: 'Project A',
                    tags: [],
                    children: []
                }
            },
            {
                id: 'task3',
                content: 'Task 3',
                filePath: 'file3.md',
                line: 1,
                completed: false,
                status: ' ',
                originalMarkdown: '- [ ] Task 3',
                metadata: {
                    tgProject: {
                        type: 'path',
                        name: 'Project B',
                        readonly: true
                    },
                    tags: [],
                    children: []
                }
            }
        ];
        const tree = buildProjectTreeFromTasks(tasks);
        expect(tree.children.length).toBe(2);
        const projectA = tree.children.find(n => n.name === 'Project A');
        expect(projectA).toBeDefined();
        expect(projectA.data.totalTaskCount).toBe(2);
        const projectB = tree.children.find(n => n.name === 'Project B');
        expect(projectB).toBeDefined();
        expect(projectB.data.totalTaskCount).toBe(1);
    });
});
describe('findNodeByPath', () => {
    let tree;
    beforeEach(() => {
        const projectsMap = new Map([
            ['Project A', new Set(['task1'])],
            ['Project A/SubProject 1', new Set(['task2'])],
            ['Project B', new Set(['task3'])]
        ]);
        tree = buildProjectTree(projectsMap);
    });
    it('should find node by path', () => {
        const node = findNodeByPath(tree, 'Project A/SubProject 1');
        expect(node).toBeDefined();
        expect(node.name).toBe('SubProject 1');
    });
    it('should return root for empty path', () => {
        const node = findNodeByPath(tree, '');
        expect(node).toBe(tree);
    });
    it('should return undefined for non-existent path', () => {
        const node = findNodeByPath(tree, 'Project C');
        expect(node).toBeUndefined();
    });
});
describe('getAllDescendants', () => {
    it('should get all descendant nodes', () => {
        const projectsMap = new Map([
            ['Parent', new Set(['task1'])],
            ['Parent/Child1', new Set(['task2'])],
            ['Parent/Child1/GrandChild', new Set(['task3'])],
            ['Parent/Child2', new Set(['task4'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        const parent = tree.children[0];
        const descendants = getAllDescendants(parent);
        expect(descendants.length).toBe(3);
        const names = descendants.map(d => d.name);
        expect(names).toContain('Child1');
        expect(names).toContain('Child2');
        expect(names).toContain('GrandChild');
    });
    it('should return empty array for leaf node', () => {
        const projectsMap = new Map([
            ['Project', new Set(['task1'])]
        ]);
        const tree = buildProjectTree(projectsMap);
        const project = tree.children[0];
        const descendants = getAllDescendants(project);
        expect(descendants.length).toBe(0);
    });
});
describe('expand/collapse state management', () => {
    let tree;
    beforeEach(() => {
        const projectsMap = new Map([
            ['A', new Set(['task1'])],
            ['A/B', new Set(['task2'])],
            ['A/B/C', new Set(['task3'])],
            ['D', new Set(['task4'])]
        ]);
        tree = buildProjectTree(projectsMap);
    });
    it('should get expanded paths', () => {
        // Expand some nodes
        tree.children[0].isExpanded = true;
        tree.children[0].children[0].isExpanded = true;
        const expandedPaths = getExpandedPaths(tree);
        expect(expandedPaths.has('A')).toBe(true);
        expect(expandedPaths.has('A/B')).toBe(true);
        expect(expandedPaths.has('D')).toBe(false);
    });
    it('should restore expanded state', () => {
        const expandedPaths = new Set(['A', 'A/B']);
        restoreExpandedState(tree, expandedPaths);
        expect(tree.children[0].isExpanded).toBe(true);
        expect(tree.children[0].children[0].isExpanded).toBe(true);
        expect(tree.children[1].isExpanded).toBe(false);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdFRyZWVCdWlsZGVyLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJwcm9qZWN0VHJlZUJ1aWxkZXIudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7R0FFRztBQUVILE9BQU8sRUFDTixnQkFBZ0IsRUFDaEIsZ0JBQWdCLEVBQ2hCLHlCQUF5QixFQUN6QixjQUFjLEVBQ2QsaUJBQWlCLEVBQ2pCLGdCQUFnQixFQUNoQixvQkFBb0IsRUFDcEIsTUFBTSw4QkFBOEIsQ0FBQztBQUl0QyxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO0lBQ2pDLEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxHQUFHLEVBQUU7UUFDM0MsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUN0RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUM7SUFDbkQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1FBQ3pDLE1BQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzdELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQztJQUNuRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7UUFDbkMsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUM1QixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7UUFDakMsTUFBTSxNQUFNLEdBQUcsZ0JB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O1FBRTdDLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzVDLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLCtCQUErQixFQUFFLEdBQUcsRUFBRTtRQUN4QyxNQUFNLGFBQWEsR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBRTVDLG9CQUFvQixDQUFDLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQztRQUUxQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0MsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzRCxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDakQsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBUZXN0cyBmb3IgcHJvamVjdCB0cmVlIGJ1aWxkZXIgdXRpbGl0aWVzXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgXHJcblx0cGFyc2VQcm9qZWN0UGF0aCwgXHJcblx0YnVpbGRQcm9qZWN0VHJlZSwgXHJcblx0YnVpbGRQcm9qZWN0VHJlZUZyb21UYXNrcyxcclxuXHRmaW5kTm9kZUJ5UGF0aCxcclxuXHRnZXRBbGxEZXNjZW5kYW50cyxcclxuXHRnZXRFeHBhbmRlZFBhdGhzLFxyXG5cdHJlc3RvcmVFeHBhbmRlZFN0YXRlXHJcbn0gZnJvbSAnLi4vY29yZS9wcm9qZWN0LXRyZWUtYnVpbGRlcic7XHJcbmltcG9ydCB7IFRyZWVOb2RlLCBQcm9qZWN0Tm9kZURhdGEgfSBmcm9tICcuLi90eXBlcy90cmVlJztcclxuaW1wb3J0IHsgVGFzayB9IGZyb20gJy4uL3R5cGVzL3Rhc2snO1xyXG5cclxuZGVzY3JpYmUoJ3BhcnNlUHJvamVjdFBhdGgnLCAoKSA9PiB7XHJcblx0aXQoJ3Nob3VsZCBwYXJzZSBzaW1wbGUgcHJvamVjdCBwYXRoJywgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcmVzdWx0ID0gcGFyc2VQcm9qZWN0UGF0aCgnUHJvamVjdC9TdWJQcm9qZWN0Jyk7XHJcblx0XHRleHBlY3QocmVzdWx0KS50b0VxdWFsKFsnUHJvamVjdCcsICdTdWJQcm9qZWN0J10pO1xyXG5cdH0pO1xyXG5cclxuXHRpdCgnc2hvdWxkIGhhbmRsZSBjdXN0b20gc2VwYXJhdG9yJywgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcmVzdWx0ID0gcGFyc2VQcm9qZWN0UGF0aCgnUHJvamVjdDo6U3ViUHJvamVjdCcsICc6OicpO1xyXG5cdFx0ZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbJ1Byb2plY3QnLCAnU3ViUHJvamVjdCddKTtcclxuXHR9KTtcclxuXHJcblx0aXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcGF0aCcsICgpID0+IHtcclxuXHRcdGNvbnN0IHJlc3VsdCA9IHBhcnNlUHJvamVjdFBhdGgoJycpO1xyXG5cdFx0ZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XHJcblx0fSk7XHJcblxyXG5cdGl0KCdzaG91bGQgdHJpbSB3aGl0ZXNwYWNlJywgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcmVzdWx0ID0gcGFyc2VQcm9qZWN0UGF0aCgnICBQcm9qZWN0L1N1YlByb2plY3QgICcpO1xyXG5cdFx0ZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbJ1Byb2plY3QnLCAnU3ViUHJvamVjdCddKTtcclxuXHR9KTtcclxuXHJcblx0aXQoJ3Nob3VsZCBoYW5kbGUgZHVwbGljYXRlIHNlcGFyYXRvcnMnLCAoKSA9PiB7XHJcblx0XHRjb25zdCByZXN1bHQgPSBwYXJzZVByb2plY3RQYXRoKCdQcm9qZWN0Ly9TdWJQcm9qZWN0Ly8vVGFzaycpO1xyXG5cdFx0ZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbJ1Byb2plY3QnLCAnU3ViUHJvamVjdCcsICdUYXNrJ10pO1xyXG5cdH0pO1xyXG5cclxuXHRpdCgnc2hvdWxkIGhhbmRsZSBsZWFkaW5nIGFuZCB0cmFpbGluZyBzZXBhcmF0b3JzJywgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcmVzdWx0ID0gcGFyc2VQcm9qZWN0UGF0aCgnL1Byb2plY3QvU3ViUHJvamVjdC8nKTtcclxuXHRcdGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoWydQcm9qZWN0JywgJ1N1YlByb2plY3QnXSk7XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ2J1aWxkUHJvamVjdFRyZWUnLCAoKSA9PiB7XHJcblx0aXQoJ3Nob3VsZCBidWlsZCB0cmVlIGZyb20gZmxhdCBwcm9qZWN0IG1hcCcsICgpID0+IHtcclxuXHRcdGNvbnN0IHByb2plY3RzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PihbXHJcblx0XHRcdFsnUHJvamVjdCBBJywgbmV3IFNldChbJ3Rhc2sxJywgJ3Rhc2syJ10pXSxcclxuXHRcdFx0WydQcm9qZWN0IEEvU3ViUHJvamVjdCAxJywgbmV3IFNldChbJ3Rhc2szJ10pXSxcclxuXHRcdFx0WydQcm9qZWN0IEEvU3ViUHJvamVjdCAyJywgbmV3IFNldChbJ3Rhc2s0JywgJ3Rhc2s1J10pXSxcclxuXHRcdFx0WydQcm9qZWN0IEInLCBuZXcgU2V0KFsndGFzazYnXSldXHJcblx0XHRdKTtcclxuXHJcblx0XHRjb25zdCB0cmVlID0gYnVpbGRQcm9qZWN0VHJlZShwcm9qZWN0c01hcCk7XHJcblxyXG5cdFx0ZXhwZWN0KHRyZWUuaWQpLnRvQmUoJ3Jvb3QnKTtcclxuXHRcdGV4cGVjdCh0cmVlLmNoaWxkcmVuLmxlbmd0aCkudG9CZSgyKTtcclxuXHJcblx0XHRjb25zdCBwcm9qZWN0QSA9IHRyZWUuY2hpbGRyZW4uZmluZChuID0+IG4ubmFtZSA9PT0gJ1Byb2plY3QgQScpO1xyXG5cdFx0ZXhwZWN0KHByb2plY3RBKS50b0JlRGVmaW5lZCgpO1xyXG5cdFx0ZXhwZWN0KHByb2plY3RBIS5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMik7XHJcblx0XHRleHBlY3QocHJvamVjdEEhLmRhdGEuZGlyZWN0VGFza0NvdW50KS50b0JlKDIpO1xyXG5cdFx0ZXhwZWN0KHByb2plY3RBIS5kYXRhLnRvdGFsVGFza0NvdW50KS50b0JlKDUpO1xyXG5cclxuXHRcdGNvbnN0IHN1YlByb2plY3QxID0gcHJvamVjdEEhLmNoaWxkcmVuLmZpbmQobiA9PiBuLm5hbWUgPT09ICdTdWJQcm9qZWN0IDEnKTtcclxuXHRcdGV4cGVjdChzdWJQcm9qZWN0MSkudG9CZURlZmluZWQoKTtcclxuXHRcdGV4cGVjdChzdWJQcm9qZWN0MSEuZGF0YS5kaXJlY3RUYXNrQ291bnQpLnRvQmUoMSk7XHJcblx0XHRleHBlY3Qoc3ViUHJvamVjdDEhLmRhdGEudG90YWxUYXNrQ291bnQpLnRvQmUoMSk7XHJcblx0fSk7XHJcblxyXG5cdGl0KCdzaG91bGQgaGFuZGxlIHNpbmdsZSBsZXZlbCBwcm9qZWN0cycsICgpID0+IHtcclxuXHRcdGNvbnN0IHByb2plY3RzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PihbXHJcblx0XHRcdFsnUHJvamVjdCBBJywgbmV3IFNldChbJ3Rhc2sxJywgJ3Rhc2syJ10pXSxcclxuXHRcdFx0WydQcm9qZWN0IEInLCBuZXcgU2V0KFsndGFzazMnXSldXHJcblx0XHRdKTtcclxuXHJcblx0XHRjb25zdCB0cmVlID0gYnVpbGRQcm9qZWN0VHJlZShwcm9qZWN0c01hcCk7XHJcblxyXG5cdFx0ZXhwZWN0KHRyZWUuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDIpO1xyXG5cdFx0ZXhwZWN0KHRyZWUuY2hpbGRyZW5bMF0uY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDApO1xyXG5cdFx0ZXhwZWN0KHRyZWUuY2hpbGRyZW5bMV0uY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDApO1xyXG5cdH0pO1xyXG5cclxuXHRpdCgnc2hvdWxkIGhhbmRsZSBkZWVwIG5lc3RpbmcnLCAoKSA9PiB7XHJcblx0XHRjb25zdCBwcm9qZWN0c01hcCA9IG5ldyBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj4oW1xyXG5cdFx0XHRbJ0EvQi9DL0QnLCBuZXcgU2V0KFsndGFzazEnXSldXHJcblx0XHRdKTtcclxuXHJcblx0XHRjb25zdCB0cmVlID0gYnVpbGRQcm9qZWN0VHJlZShwcm9qZWN0c01hcCk7XHJcblxyXG5cdFx0bGV0IGN1cnJlbnQgPSB0cmVlO1xyXG5cdFx0Y29uc3QgZXhwZWN0ZWROYW1lcyA9IFsnQScsICdCJywgJ0MnLCAnRCddO1xyXG5cdFx0XHJcblx0XHRmb3IgKGNvbnN0IG5hbWUgb2YgZXhwZWN0ZWROYW1lcykge1xyXG5cdFx0XHRleHBlY3QoY3VycmVudC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMSk7XHJcblx0XHRcdGN1cnJlbnQgPSBjdXJyZW50LmNoaWxkcmVuWzBdO1xyXG5cdFx0XHRleHBlY3QoY3VycmVudC5uYW1lKS50b0JlKG5hbWUpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRleHBlY3QoY3VycmVudC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMCk7XHJcblx0fSk7XHJcblxyXG5cdGl0KCdzaG91bGQgc29ydCBjaGlsZHJlbiBhbHBoYWJldGljYWxseScsICgpID0+IHtcclxuXHRcdGNvbnN0IHByb2plY3RzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PihbXHJcblx0XHRcdFsnWmVicmEnLCBuZXcgU2V0KFsndGFzazEnXSldLFxyXG5cdFx0XHRbJ0FwcGxlJywgbmV3IFNldChbJ3Rhc2syJ10pXSxcclxuXHRcdFx0WydCYW5hbmEnLCBuZXcgU2V0KFsndGFzazMnXSldXHJcblx0XHRdKTtcclxuXHJcblx0XHRjb25zdCB0cmVlID0gYnVpbGRQcm9qZWN0VHJlZShwcm9qZWN0c01hcCk7XHJcblxyXG5cdFx0ZXhwZWN0KHRyZWUuY2hpbGRyZW5bMF0ubmFtZSkudG9CZSgnQXBwbGUnKTtcclxuXHRcdGV4cGVjdCh0cmVlLmNoaWxkcmVuWzFdLm5hbWUpLnRvQmUoJ0JhbmFuYScpO1xyXG5cdFx0ZXhwZWN0KHRyZWUuY2hpbGRyZW5bMl0ubmFtZSkudG9CZSgnWmVicmEnKTtcclxuXHR9KTtcclxuXHJcblx0aXQoJ3Nob3VsZCBjYWxjdWxhdGUgY3VtdWxhdGl2ZSB0YXNrIGNvdW50cyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcblx0XHRjb25zdCBwcm9qZWN0c01hcCA9IG5ldyBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj4oW1xyXG5cdFx0XHRbJ1BhcmVudCcsIG5ldyBTZXQoWyd0YXNrMScsICd0YXNrMiddKV0sXHJcblx0XHRcdFsnUGFyZW50L0NoaWxkMScsIG5ldyBTZXQoWyd0YXNrMycsICd0YXNrNCddKV0sXHJcblx0XHRcdFsnUGFyZW50L0NoaWxkMS9HcmFuZENoaWxkJywgbmV3IFNldChbJ3Rhc2s1J10pXSxcclxuXHRcdFx0WydQYXJlbnQvQ2hpbGQyJywgbmV3IFNldChbJ3Rhc2s2J10pXVxyXG5cdFx0XSk7XHJcblxyXG5cdFx0Y29uc3QgdHJlZSA9IGJ1aWxkUHJvamVjdFRyZWUocHJvamVjdHNNYXApO1xyXG5cdFx0Y29uc3QgcGFyZW50ID0gdHJlZS5jaGlsZHJlblswXTtcclxuXHJcblx0XHRleHBlY3QocGFyZW50LmRhdGEuZGlyZWN0VGFza0NvdW50KS50b0JlKDIpO1xyXG5cdFx0ZXhwZWN0KHBhcmVudC5kYXRhLnRvdGFsVGFza0NvdW50KS50b0JlKDYpO1xyXG5cclxuXHRcdGNvbnN0IGNoaWxkMSA9IHBhcmVudC5jaGlsZHJlbi5maW5kKG4gPT4gbi5uYW1lID09PSAnQ2hpbGQxJyk7XHJcblx0XHRleHBlY3QoY2hpbGQxIS5kYXRhLmRpcmVjdFRhc2tDb3VudCkudG9CZSgyKTtcclxuXHRcdGV4cGVjdChjaGlsZDEhLmRhdGEudG90YWxUYXNrQ291bnQpLnRvQmUoMyk7XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ2J1aWxkUHJvamVjdFRyZWVGcm9tVGFza3MnLCAoKSA9PiB7XHJcblx0aXQoJ3Nob3VsZCBidWlsZCB0cmVlIGZyb20gdGFzayBsaXN0JywgKCkgPT4ge1xyXG5cdFx0Y29uc3QgdGFza3M6IFRhc2tbXSA9IFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlkOiAndGFzazEnLFxyXG5cdFx0XHRcdGNvbnRlbnQ6ICdUYXNrIDEnLFxyXG5cdFx0XHRcdGZpbGVQYXRoOiAnZmlsZTEubWQnLFxyXG5cdFx0XHRcdGxpbmU6IDEsXHJcblx0XHRcdFx0Y29tcGxldGVkOiBmYWxzZSxcclxuXHRcdFx0XHRzdGF0dXM6ICcgJyxcclxuXHRcdFx0XHRvcmlnaW5hbE1hcmtkb3duOiAnLSBbIF0gVGFzayAxJyxcclxuXHRcdFx0XHRtZXRhZGF0YToge1xyXG5cdFx0XHRcdFx0cHJvamVjdDogJ1Byb2plY3QgQS9TdWJQcm9qZWN0IDEnLFxyXG5cdFx0XHRcdFx0dGFnczogW10sXHJcblx0XHRcdFx0XHRjaGlsZHJlbjogW11cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZDogJ3Rhc2syJyxcclxuXHRcdFx0XHRjb250ZW50OiAnVGFzayAyJyxcclxuXHRcdFx0XHRmaWxlUGF0aDogJ2ZpbGUyLm1kJyxcclxuXHRcdFx0XHRsaW5lOiAxLFxyXG5cdFx0XHRcdGNvbXBsZXRlZDogZmFsc2UsXHJcblx0XHRcdFx0c3RhdHVzOiAnICcsXHJcblx0XHRcdFx0b3JpZ2luYWxNYXJrZG93bjogJy0gWyBdIFRhc2sgMicsXHJcblx0XHRcdFx0bWV0YWRhdGE6IHtcclxuXHRcdFx0XHRcdHByb2plY3Q6ICdQcm9qZWN0IEEnLFxyXG5cdFx0XHRcdFx0dGFnczogW10sXHJcblx0XHRcdFx0XHRjaGlsZHJlbjogW11cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZDogJ3Rhc2szJyxcclxuXHRcdFx0XHRjb250ZW50OiAnVGFzayAzJyxcclxuXHRcdFx0XHRmaWxlUGF0aDogJ2ZpbGUzLm1kJyxcclxuXHRcdFx0XHRsaW5lOiAxLFxyXG5cdFx0XHRcdGNvbXBsZXRlZDogZmFsc2UsXHJcblx0XHRcdFx0c3RhdHVzOiAnICcsXHJcblx0XHRcdFx0b3JpZ2luYWxNYXJrZG93bjogJy0gWyBdIFRhc2sgMycsXHJcblx0XHRcdFx0bWV0YWRhdGE6IHtcclxuXHRcdFx0XHRcdHRnUHJvamVjdDoge1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncGF0aCcsXHJcblx0XHRcdFx0XHRcdG5hbWU6ICdQcm9qZWN0IEInLFxyXG5cdFx0XHRcdFx0XHRyZWFkb25seTogdHJ1ZVxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHRhZ3M6IFtdLFxyXG5cdFx0XHRcdFx0Y2hpbGRyZW46IFtdXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRdO1xyXG5cclxuXHRcdGNvbnN0IHRyZWUgPSBidWlsZFByb2plY3RUcmVlRnJvbVRhc2tzKHRhc2tzKTtcclxuXHJcblx0XHRleHBlY3QodHJlZS5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMik7XHJcblx0XHRcclxuXHRcdGNvbnN0IHByb2plY3RBID0gdHJlZS5jaGlsZHJlbi5maW5kKG4gPT4gbi5uYW1lID09PSAnUHJvamVjdCBBJyk7XHJcblx0XHRleHBlY3QocHJvamVjdEEpLnRvQmVEZWZpbmVkKCk7XHJcblx0XHRleHBlY3QocHJvamVjdEEhLmRhdGEudG90YWxUYXNrQ291bnQpLnRvQmUoMik7XHJcblx0XHRcclxuXHRcdGNvbnN0IHByb2plY3RCID0gdHJlZS5jaGlsZHJlbi5maW5kKG4gPT4gbi5uYW1lID09PSAnUHJvamVjdCBCJyk7XHJcblx0XHRleHBlY3QocHJvamVjdEIpLnRvQmVEZWZpbmVkKCk7XHJcblx0XHRleHBlY3QocHJvamVjdEIhLmRhdGEudG90YWxUYXNrQ291bnQpLnRvQmUoMSk7XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ2ZpbmROb2RlQnlQYXRoJywgKCkgPT4ge1xyXG5cdGxldCB0cmVlOiBUcmVlTm9kZTxQcm9qZWN0Tm9kZURhdGE+O1xyXG5cclxuXHRiZWZvcmVFYWNoKCgpID0+IHtcclxuXHRcdGNvbnN0IHByb2plY3RzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PihbXHJcblx0XHRcdFsnUHJvamVjdCBBJywgbmV3IFNldChbJ3Rhc2sxJ10pXSxcclxuXHRcdFx0WydQcm9qZWN0IEEvU3ViUHJvamVjdCAxJywgbmV3IFNldChbJ3Rhc2syJ10pXSxcclxuXHRcdFx0WydQcm9qZWN0IEInLCBuZXcgU2V0KFsndGFzazMnXSldXHJcblx0XHRdKTtcclxuXHRcdHRyZWUgPSBidWlsZFByb2plY3RUcmVlKHByb2plY3RzTWFwKTtcclxuXHR9KTtcclxuXHJcblx0aXQoJ3Nob3VsZCBmaW5kIG5vZGUgYnkgcGF0aCcsICgpID0+IHtcclxuXHRcdGNvbnN0IG5vZGUgPSBmaW5kTm9kZUJ5UGF0aCh0cmVlLCAnUHJvamVjdCBBL1N1YlByb2plY3QgMScpO1xyXG5cdFx0ZXhwZWN0KG5vZGUpLnRvQmVEZWZpbmVkKCk7XHJcblx0XHRleHBlY3Qobm9kZSEubmFtZSkudG9CZSgnU3ViUHJvamVjdCAxJyk7XHJcblx0fSk7XHJcblxyXG5cdGl0KCdzaG91bGQgcmV0dXJuIHJvb3QgZm9yIGVtcHR5IHBhdGgnLCAoKSA9PiB7XHJcblx0XHRjb25zdCBub2RlID0gZmluZE5vZGVCeVBhdGgodHJlZSwgJycpO1xyXG5cdFx0ZXhwZWN0KG5vZGUpLnRvQmUodHJlZSk7XHJcblx0fSk7XHJcblxyXG5cdGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCBmb3Igbm9uLWV4aXN0ZW50IHBhdGgnLCAoKSA9PiB7XHJcblx0XHRjb25zdCBub2RlID0gZmluZE5vZGVCeVBhdGgodHJlZSwgJ1Byb2plY3QgQycpO1xyXG5cdFx0ZXhwZWN0KG5vZGUpLnRvQmVVbmRlZmluZWQoKTtcclxuXHR9KTtcclxufSk7XHJcblxyXG5kZXNjcmliZSgnZ2V0QWxsRGVzY2VuZGFudHMnLCAoKSA9PiB7XHJcblx0aXQoJ3Nob3VsZCBnZXQgYWxsIGRlc2NlbmRhbnQgbm9kZXMnLCAoKSA9PiB7XHJcblx0XHRjb25zdCBwcm9qZWN0c01hcCA9IG5ldyBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj4oW1xyXG5cdFx0XHRbJ1BhcmVudCcsIG5ldyBTZXQoWyd0YXNrMSddKV0sXHJcblx0XHRcdFsnUGFyZW50L0NoaWxkMScsIG5ldyBTZXQoWyd0YXNrMiddKV0sXHJcblx0XHRcdFsnUGFyZW50L0NoaWxkMS9HcmFuZENoaWxkJywgbmV3IFNldChbJ3Rhc2szJ10pXSxcclxuXHRcdFx0WydQYXJlbnQvQ2hpbGQyJywgbmV3IFNldChbJ3Rhc2s0J10pXVxyXG5cdFx0XSk7XHJcblxyXG5cdFx0Y29uc3QgdHJlZSA9IGJ1aWxkUHJvamVjdFRyZWUocHJvamVjdHNNYXApO1xyXG5cdFx0Y29uc3QgcGFyZW50ID0gdHJlZS5jaGlsZHJlblswXTtcclxuXHRcdGNvbnN0IGRlc2NlbmRhbnRzID0gZ2V0QWxsRGVzY2VuZGFudHMocGFyZW50KTtcclxuXHJcblx0XHRleHBlY3QoZGVzY2VuZGFudHMubGVuZ3RoKS50b0JlKDMpO1xyXG5cdFx0XHJcblx0XHRjb25zdCBuYW1lcyA9IGRlc2NlbmRhbnRzLm1hcChkID0+IGQubmFtZSk7XHJcblx0XHRleHBlY3QobmFtZXMpLnRvQ29udGFpbignQ2hpbGQxJyk7XHJcblx0XHRleHBlY3QobmFtZXMpLnRvQ29udGFpbignQ2hpbGQyJyk7XHJcblx0XHRleHBlY3QobmFtZXMpLnRvQ29udGFpbignR3JhbmRDaGlsZCcpO1xyXG5cdH0pO1xyXG5cclxuXHRpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSBmb3IgbGVhZiBub2RlJywgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcHJvamVjdHNNYXAgPSBuZXcgTWFwPHN0cmluZywgU2V0PHN0cmluZz4+KFtcclxuXHRcdFx0WydQcm9qZWN0JywgbmV3IFNldChbJ3Rhc2sxJ10pXVxyXG5cdFx0XSk7XHJcblxyXG5cdFx0Y29uc3QgdHJlZSA9IGJ1aWxkUHJvamVjdFRyZWUocHJvamVjdHNNYXApO1xyXG5cdFx0Y29uc3QgcHJvamVjdCA9IHRyZWUuY2hpbGRyZW5bMF07XHJcblx0XHRjb25zdCBkZXNjZW5kYW50cyA9IGdldEFsbERlc2NlbmRhbnRzKHByb2plY3QpO1xyXG5cclxuXHRcdGV4cGVjdChkZXNjZW5kYW50cy5sZW5ndGgpLnRvQmUoMCk7XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ2V4cGFuZC9jb2xsYXBzZSBzdGF0ZSBtYW5hZ2VtZW50JywgKCkgPT4ge1xyXG5cdGxldCB0cmVlOiBUcmVlTm9kZTxQcm9qZWN0Tm9kZURhdGE+O1xyXG5cclxuXHRiZWZvcmVFYWNoKCgpID0+IHtcclxuXHRcdGNvbnN0IHByb2plY3RzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PihbXHJcblx0XHRcdFsnQScsIG5ldyBTZXQoWyd0YXNrMSddKV0sXHJcblx0XHRcdFsnQS9CJywgbmV3IFNldChbJ3Rhc2syJ10pXSxcclxuXHRcdFx0WydBL0IvQycsIG5ldyBTZXQoWyd0YXNrMyddKV0sXHJcblx0XHRcdFsnRCcsIG5ldyBTZXQoWyd0YXNrNCddKV1cclxuXHRcdF0pO1xyXG5cdFx0dHJlZSA9IGJ1aWxkUHJvamVjdFRyZWUocHJvamVjdHNNYXApO1xyXG5cdH0pO1xyXG5cclxuXHRpdCgnc2hvdWxkIGdldCBleHBhbmRlZCBwYXRocycsICgpID0+IHtcclxuXHRcdC8vIEV4cGFuZCBzb21lIG5vZGVzXHJcblx0XHR0cmVlLmNoaWxkcmVuWzBdLmlzRXhwYW5kZWQgPSB0cnVlO1xyXG5cdFx0dHJlZS5jaGlsZHJlblswXS5jaGlsZHJlblswXS5pc0V4cGFuZGVkID0gdHJ1ZTtcclxuXHJcblx0XHRjb25zdCBleHBhbmRlZFBhdGhzID0gZ2V0RXhwYW5kZWRQYXRocyh0cmVlKTtcclxuXHJcblx0XHRleHBlY3QoZXhwYW5kZWRQYXRocy5oYXMoJ0EnKSkudG9CZSh0cnVlKTtcclxuXHRcdGV4cGVjdChleHBhbmRlZFBhdGhzLmhhcygnQS9CJykpLnRvQmUodHJ1ZSk7XHJcblx0XHRleHBlY3QoZXhwYW5kZWRQYXRocy5oYXMoJ0QnKSkudG9CZShmYWxzZSk7XHJcblx0fSk7XHJcblxyXG5cdGl0KCdzaG91bGQgcmVzdG9yZSBleHBhbmRlZCBzdGF0ZScsICgpID0+IHtcclxuXHRcdGNvbnN0IGV4cGFuZGVkUGF0aHMgPSBuZXcgU2V0KFsnQScsICdBL0InXSk7XHJcblx0XHRcclxuXHRcdHJlc3RvcmVFeHBhbmRlZFN0YXRlKHRyZWUsIGV4cGFuZGVkUGF0aHMpO1xyXG5cclxuXHRcdGV4cGVjdCh0cmVlLmNoaWxkcmVuWzBdLmlzRXhwYW5kZWQpLnRvQmUodHJ1ZSk7XHJcblx0XHRleHBlY3QodHJlZS5jaGlsZHJlblswXS5jaGlsZHJlblswXS5pc0V4cGFuZGVkKS50b0JlKHRydWUpO1xyXG5cdFx0ZXhwZWN0KHRyZWUuY2hpbGRyZW5bMV0uaXNFeHBhbmRlZCkudG9CZShmYWxzZSk7XHJcblx0fSk7XHJcbn0pOyJdfQ==