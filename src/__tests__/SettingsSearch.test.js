// Mock Obsidian's prepareFuzzySearch
const mockPrepareFuzzySearch = jest.fn((query) => {
    return (target) => {
        // Simple mock implementation for testing
        return target.toLowerCase().includes(query.toLowerCase());
    };
});
// Mock translations
const mockT = jest.fn((key) => key);
jest.mock("obsidian", () => ({
    prepareFuzzySearch: mockPrepareFuzzySearch,
}));
jest.mock("../translations/helper", () => ({
    t: mockT,
}));
import { SettingsIndexer } from '../components/features/settings/core/SettingsIndexer';
import { SETTINGS_METADATA } from "../common/settings-metadata";
describe("Settings Search Tests", () => {
    let indexer;
    beforeEach(() => {
        indexer = new SettingsIndexer();
        jest.clearAllMocks();
    });
    describe("Settings Metadata", () => {
        test("should have valid metadata structure", () => {
            expect(SETTINGS_METADATA).toBeDefined();
            expect(Array.isArray(SETTINGS_METADATA)).toBe(true);
            expect(SETTINGS_METADATA.length).toBeGreaterThan(0);
            // Check first few items have required fields
            const firstItem = SETTINGS_METADATA[0];
            expect(firstItem).toHaveProperty("id");
            expect(firstItem).toHaveProperty("tabId");
            expect(firstItem).toHaveProperty("name");
            expect(firstItem).toHaveProperty("translationKey");
            expect(firstItem).toHaveProperty("keywords");
            expect(Array.isArray(firstItem.keywords)).toBe(true);
        });
        test("should have progress bar settings", () => {
            const progressBarMain = SETTINGS_METADATA.find((item) => item.id === "progress-bar-main");
            expect(progressBarMain).toBeDefined();
            expect(progressBarMain === null || progressBarMain === void 0 ? void 0 : progressBarMain.name).toBe("Progress bar");
            expect(progressBarMain === null || progressBarMain === void 0 ? void 0 : progressBarMain.tabId).toBe("progress-bar");
            expect(progressBarMain === null || progressBarMain === void 0 ? void 0 : progressBarMain.keywords).toContain("progress");
        });
        test("should have enable task filter setting", () => {
            const taskFilter = SETTINGS_METADATA.find((item) => item.id === "enable-task-filter");
            expect(taskFilter).toBeDefined();
            expect(taskFilter === null || taskFilter === void 0 ? void 0 : taskFilter.name).toBe("Enable Task Filter");
            expect(taskFilter === null || taskFilter === void 0 ? void 0 : taskFilter.tabId).toBe("task-filter");
        });
    });
    describe("SettingsIndexer", () => {
        test("should initialize correctly", () => {
            expect(indexer).toBeDefined();
            // Should not be initialized yet
            const stats = indexer.getStats();
            expect(stats.itemCount).toBeGreaterThan(0);
        });
        test("should build index on first search", () => {
            const results = indexer.search("progress");
            expect(mockT).toHaveBeenCalled();
        });
        test("should search by name", () => {
            const results = indexer.search("progress");
            console.log("Search results for 'progress':", results.length);
            results.forEach((result) => {
                console.log(`- ${result.item.name} (${result.matchType}, score: ${result.score})`);
            });
            expect(results.length).toBeGreaterThan(0);
            // Should find progress bar settings
            const progressResult = results.find((result) => result.item.id === "progress-bar-main" ||
                result.item.name.toLowerCase().includes("progress"));
            expect(progressResult).toBeDefined();
        });
        test("should search by description", () => {
            const results = indexer.search("toggle");
            console.log("Search results for 'toggle':", results.length);
            results.forEach((result) => {
                console.log(`- ${result.item.name} (${result.matchType}, score: ${result.score})`);
                if (result.item.description) {
                    console.log(`  Description: ${result.item.description.substring(0, 100)}...`);
                }
            });
            expect(results.length).toBeGreaterThan(0);
        });
        test("should search by keywords", () => {
            const results = indexer.search("checkbox");
            console.log("Search results for 'checkbox':", results.length);
            results.forEach((result) => {
                console.log(`- ${result.item.name} (${result.matchType}, score: ${result.score})`);
                console.log(`  Keywords: ${result.item.keywords.join(", ")}`);
            });
            expect(results.length).toBeGreaterThan(0);
        });
        test("should prioritize name matches over description matches", () => {
            const results = indexer.search("filter");
            console.log("Search results for 'filter' with scores:");
            results.forEach((result) => {
                console.log(`- ${result.item.name} (${result.matchType}, score: ${result.score})`);
            });
            expect(results.length).toBeGreaterThan(0);
            // Find name matches and description matches
            const nameMatches = results.filter((r) => r.matchType === "name");
            const descriptionMatches = results.filter((r) => r.matchType === "description");
            if (nameMatches.length > 0 && descriptionMatches.length > 0) {
                // Name matches should have higher scores
                const highestNameScore = Math.max(...nameMatches.map((r) => r.score));
                const highestDescScore = Math.max(...descriptionMatches.map((r) => r.score));
                expect(highestNameScore).toBeGreaterThan(highestDescScore);
            }
        });
        test("should return empty results for empty query", () => {
            const results = indexer.search("");
            expect(results.length).toBe(0);
        });
        test("should return empty results for very short query", () => {
            const results = indexer.search("a");
            expect(results.length).toBe(0);
        });
        test("should return results for 2+ character query", () => {
            const results = indexer.search("pr");
            expect(results.length).toBeGreaterThan(0);
        });
        test("should limit results", () => {
            const results = indexer.search("task");
            console.log(`Found ${results.length} results for 'task'`);
            expect(results.length).toBeLessThanOrEqual(10); // Default limit
        });
        test("should handle case insensitive search", () => {
            const lowerResults = indexer.search("progress");
            const upperResults = indexer.search("PROGRESS");
            const mixedResults = indexer.search("Progress");
            expect(lowerResults.length).toBe(upperResults.length);
            expect(lowerResults.length).toBe(mixedResults.length);
        });
    });
    describe("Translation Integration", () => {
        test("should call translation function for setting names", () => {
            indexer.search("progress");
            // Should have called t() for translating setting names
            expect(mockT).toHaveBeenCalled();
            // Check if it was called with expected translation keys
            const calls = mockT.mock.calls.map((call) => call[0]);
            console.log("Translation calls:", calls.slice(0, 10)); // Show first 10 calls
            expect(calls).toContain("Progress bar");
        });
    });
    describe("Edge Cases", () => {
        test("should handle special characters in search", () => {
            const results = indexer.search("task-filter");
            expect(results.length).toBeGreaterThanOrEqual(0);
        });
        test("should handle unicode characters", () => {
            const results = indexer.search("设置");
            expect(results.length).toBeGreaterThanOrEqual(0);
        });
        test("should handle numbers in search", () => {
            const results = indexer.search("100");
            expect(results.length).toBeGreaterThanOrEqual(0);
        });
    });
    describe("Performance", () => {
        test("should build index quickly", () => {
            const start = performance.now();
            indexer.initialize();
            const end = performance.now();
            const buildTime = end - start;
            console.log(`Index build time: ${buildTime.toFixed(2)}ms`);
            expect(buildTime).toBeLessThan(50); // Should be under 50ms
        });
        test("should search quickly", () => {
            indexer.initialize(); // Pre-initialize
            const start = performance.now();
            const results = indexer.search("progress");
            const end = performance.now();
            const searchTime = end - start;
            console.log(`Search time: ${searchTime.toFixed(2)}ms for ${results.length} results`);
            expect(searchTime).toBeLessThan(10); // Should be under 10ms
        });
    });
    describe("Specific Setting Tests", () => {
        test("should find 'Enable Task Filter' setting", () => {
            const results = indexer.search("enable task filter");
            console.log("Searching for 'enable task filter':");
            results.forEach((result) => {
                console.log(`- ${result.item.name} (ID: ${result.item.id})`);
            });
            const exactMatch = results.find((r) => r.item.id === "enable-task-filter");
            expect(exactMatch).toBeDefined();
        });
        test("should find progress bar settings", () => {
            const results = indexer.search("progress bar");
            console.log("Searching for 'progress bar':");
            results.forEach((result) => {
                console.log(`- ${result.item.name} (ID: ${result.item.id})`);
            });
            const progressBarMain = results.find((r) => r.item.id === "progress-bar-main");
            expect(progressBarMain).toBeDefined();
            expect(progressBarMain === null || progressBarMain === void 0 ? void 0 : progressBarMain.matchType).toBe("name");
        });
        test("should find settings by partial name", () => {
            const results = indexer.search("workflow");
            console.log("Searching for 'workflow':");
            results.forEach((result) => {
                console.log(`- ${result.item.name} (ID: ${result.item.id})`);
            });
            expect(results.length).toBeGreaterThan(0);
            // Should find workflow-related settings
            const workflowSettings = results.filter((r) => r.item.name.toLowerCase().includes("workflow") ||
                r.item.tabId === "workflow");
            expect(workflowSettings.length).toBeGreaterThan(0);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2V0dGluZ3NTZWFyY2gudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlNldHRpbmdzU2VhcmNoLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEscUNBQXFDO0FBQ3JDLE1BQU0sc0JBQXNCLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQWEsRUFBRSxFQUFFO0lBQ3hELE9BQU8sQ0FBQyxNQUFjLEVBQUUsRUFBRTtRQUN6Qix5Q0FBeUM7UUFDekMsT0FBTyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO0lBQzNELENBQUMsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUgsb0JBQW9CO0FBQ3BCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBRTVDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDNUIsa0JBQWtCLEVBQUUsc0JBQXNCO0NBQzFDLENBQUMsQ0FBQyxDQUFDO0FBRUosSUFBSSxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLENBQUMsRUFBRSxLQUFLO0NBQ1IsQ0FBQyxDQUFDLENBQUM7QUFFSixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0RBQXNELENBQUM7QUFDdkYsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFaEUsUUFBUSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRTtJQUN0QyxJQUFJLE9BQXdCLENBQUM7SUFFN0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNmLE9BQU8sR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN0QixDQUFDLENBQUMs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LE1BQU0sQ0FBQyxlQUFlLGFBQWYsZUFBZSx1QkFBZixlQUFlLENBQUUsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLHNDQUFzQyxFQUFFLEdBQUcsRUFBRTtZQUNqRCxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRTNDLE9BQU8sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQztZQUN6QyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7Z0JBQzFCLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDOUQsQ0FBQyxDQUFDLENBQUM7WUFFSCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUUxQyx3Q0FBd0M7WUFDeEMsTUFBTSxnQkFBZ0IsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUN0QyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQ0wsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQztnQkFDOUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLEtBQUssVUFBVSxDQUM1QixDQUFDO1lBQ0YsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwRCxDQUFDLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBNb2NrIE9ic2lkaWFuJ3MgcHJlcGFyZUZ1enp5U2VhcmNoXHJcbmNvbnN0IG1vY2tQcmVwYXJlRnV6enlTZWFyY2ggPSBqZXN0LmZuKChxdWVyeTogc3RyaW5nKSA9PiB7XHJcblx0cmV0dXJuICh0YXJnZXQ6IHN0cmluZykgPT4ge1xyXG5cdFx0Ly8gU2ltcGxlIG1vY2sgaW1wbGVtZW50YXRpb24gZm9yIHRlc3RpbmdcclxuXHRcdHJldHVybiB0YXJnZXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKTtcclxuXHR9O1xyXG59KTtcclxuXHJcbi8vIE1vY2sgdHJhbnNsYXRpb25zXHJcbmNvbnN0IG1vY2tUID0gamVzdC5mbigoa2V5OiBzdHJpbmcpID0+IGtleSk7XHJcblxyXG5qZXN0Lm1vY2soXCJvYnNpZGlhblwiLCAoKSA9PiAoe1xyXG5cdHByZXBhcmVGdXp6eVNlYXJjaDogbW9ja1ByZXBhcmVGdXp6eVNlYXJjaCxcclxufSkpO1xyXG5cclxuamVzdC5tb2NrKFwiLi4vdHJhbnNsYXRpb25zL2hlbHBlclwiLCAoKSA9PiAoe1xyXG5cdHQ6IG1vY2tULFxyXG59KSk7XHJcblxyXG5pbXBvcnQgeyBTZXR0aW5nc0luZGV4ZXIgfSBmcm9tICcuLi9jb21wb25lbnRzL2ZlYXR1cmVzL3NldHRpbmdzL2NvcmUvU2V0dGluZ3NJbmRleGVyJztcclxuaW1wb3J0IHsgU0VUVElOR1NfTUVUQURBVEEgfSBmcm9tIFwiLi4vY29tbW9uL3NldHRpbmdzLW1ldGFkYXRhXCI7XHJcblxyXG5kZXNjcmliZShcIlNldHRpbmdzIFNlYXJjaCBUZXN0c1wiLCAoKSA9PiB7XHJcblx0bGV0IGluZGV4ZXI6IFNldHRpbmdzSW5kZXhlcjtcclxuXHJcblx0YmVmb3JlRWFjaCgoKSA9PiB7XHJcblx0XHRpbmRleGVyID0gbmV3IFNldHRpbmdzSW5kZXhlcigpO1xyXG5cdFx0amVzdC5jbGVhckFsbE1vY2tzKCk7XHJcblx0fSk7XHJcblxyXG5cdGRlc2NyaWJlKFwiU2V0dGluZ3MgTWV0YWRhdGFcIiwgKCkgPT4ge1xyXG5cdFx0dGVzdChcInNob3VsZCBoYXZlIHZhbGlkIG1ldGFkYXRhIHN0cnVjdHVyZVwiLCAoKSA9PiB7XHJcblx0XHRcdGV4cGVjdChTRVRUSU5HU19NRVRBREFUQSkudG9CZURlZmluZWQoKTtcclxuXHRcdFx0ZXhwZWN0KEFycmF5LmlzQXJyYXkoU0VUVElOR1NfTUVUQURBVEEpKS50b0JlKHRydWUpO1xyXG5cdFx0XHRleHBlY3QoU0VUVElOR1NfTUVUQURBVEEubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcblxyXG5cdFx0XHQvLyBDaGVjayBmaXJzdCBmZXcgaXRlbXMgaGF2ZSByZXF1aXJlZCBmaWVsZHNcclxuXHRcdFx0Y29uc3QgZmlyc3RJdGVtID0gU0VUVElOR1NfTUVUQURBVEFbMF07XHJcblx0XHRcdGV4cGVjdChmaXJzdEl0ZW0pLnRvSGF2ZVByb3BlcnR5KFwiaWRcIik7XHJcblx0XHRcdGV4cGVjdChmaXJzdEl0ZW0pLnRvSGF2ZVByb3BlcnR5KFwidGFiSWRcIik7XHJcblx0XHRcdGV4cGVjdChmaXJzdEl0ZW0pLnRvSGF2ZVByb3BlcnR5KFwibmFtZVwiKTtcclxuXHRcdFx0ZXhwZWN0KGZpcnN0SXRlbSkudG9IYXZlUHJvcGVydHkoXCJ0cmFuc2xhdGlvbktleVwiKTtcclxuXHRcdFx0ZXhwZWN0KGZpcnN0SXRlbSkudG9IYXZlUHJvcGVydHkoXCJrZXl3b3Jkc1wiKTtcclxuXHRcdFx0ZXhwZWN0KEFycmF5LmlzQXJyYXkoZmlyc3RJdGVtLmtleXdvcmRzKSkudG9CZSh0cnVlKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgaGF2ZSBwcm9ncmVzcyBiYXIgc2V0dGluZ3NcIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zdCBwcm9ncmVzc0Jhck1haW4gPSBTRVRUSU5HU19NRVRBREFUQS5maW5kKFxyXG5cdFx0XHRcdChpdGVtKSA9PiBpdGVtLmlkID09PSBcInByb2dyZXNzLWJhci1tYWluXCJcclxuXHRcdFx0KTtcclxuXHRcdFx0ZXhwZWN0KHByb2dyZXNzQmFyTWFpbikudG9CZURlZmluZWQoKTtcclxuXHRcdFx0ZXhwZWN0KHByb2dyZXNzQmFyTWFpbj8ubmFtZSkudG9CZShcIlByb2dyZXNzIGJhclwiKTtcclxuXHRcdFx0ZXhwZWN0KHByb2dyZXNzQmFyTWFpbj8udGFiSWQpLnRvQmUoXCJwcm9ncmVzcy1iYXJcIik7XHJcblx0XHRcdGV4cGVjdChwcm9ncmVzc0Jhck1haW4/LmtleXdvcmRzKS50b0NvbnRhaW4oXCJwcm9ncmVzc1wiKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgaGF2ZSBlbmFibGUgdGFzayBmaWx0ZXIgc2V0dGluZ1wiLCAoKSA9PiB7XHJcblx0XHRcdGNvbnN0IHRhc2tGaWx0ZXIgPSBTRVRUSU5HU19NRVRBREFUQS5maW5kKFxyXG5cdFx0XHRcdChpdGVtKSA9PiBpdGVtLmlkID09PSBcImVuYWJsZS10YXNrLWZpbHRlclwiXHJcblx0XHRcdCk7XHJcblx0XHRcdGV4cGVjdCh0YXNrRmlsdGVyKS50b0JlRGVmaW5lZCgpO1xyXG5cdFx0XHRleHBlY3QodGFza0ZpbHRlcj8ubmFtZSkudG9CZShcIkVuYWJsZSBUYXNrIEZpbHRlclwiKTtcclxuXHRcdFx0ZXhwZWN0KHRhc2tGaWx0ZXI/LnRhYklkKS50b0JlKFwidGFzay1maWx0ZXJcIik7XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHJcblx0ZGVzY3JpYmUoXCJTZXR0aW5nc0luZGV4ZXJcIiwgKCkgPT4ge1xyXG5cdFx0dGVzdChcInNob3VsZCBpbml0aWFsaXplIGNvcnJlY3RseVwiLCAoKSA9PiB7XHJcblx0XHRcdGV4cGVjdChpbmRleGVyKS50b0JlRGVmaW5lZCgpO1xyXG5cclxuXHRcdFx0Ly8gU2hvdWxkIG5vdCBiZSBpbml0aWFsaXplZCB5ZXRcclxuXHRcdFx0Y29uc3Qgc3RhdHMgPSBpbmRleGVyLmdldFN0YXRzKCk7XHJcblx0XHRcdGV4cGVjdChzdGF0cy5pdGVtQ291bnQpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgYnVpbGQgaW5kZXggb24gZmlyc3Qgc2VhcmNoXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwicHJvZ3Jlc3NcIik7XHJcblx0XHRcdGV4cGVjdChtb2NrVCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGVzdChcInNob3VsZCBzZWFyY2ggYnkgbmFtZVwiLCAoKSA9PiB7XHJcblx0XHRcdGNvbnN0IHJlc3VsdHMgPSBpbmRleGVyLnNlYXJjaChcInByb2dyZXNzXCIpO1xyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCJTZWFyY2ggcmVzdWx0cyBmb3IgJ3Byb2dyZXNzJzpcIiwgcmVzdWx0cy5sZW5ndGgpO1xyXG5cdFx0XHRyZXN1bHRzLmZvckVhY2goKHJlc3VsdCkgPT4ge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFxyXG5cdFx0XHRcdFx0YC0gJHtyZXN1bHQuaXRlbS5uYW1lfSAoJHtyZXN1bHQubWF0Y2hUeXBlfSwgc2NvcmU6ICR7cmVzdWx0LnNjb3JlfSlgXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRleHBlY3QocmVzdWx0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuXHJcblx0XHRcdC8vIFNob3VsZCBmaW5kIHByb2dyZXNzIGJhciBzZXR0aW5nc1xyXG5cdFx0XHRjb25zdCBwcm9ncmVzc1Jlc3VsdCA9IHJlc3VsdHMuZmluZChcclxuXHRcdFx0XHQocmVzdWx0KSA9PlxyXG5cdFx0XHRcdFx0cmVzdWx0Lml0ZW0uaWQgPT09IFwicHJvZ3Jlc3MtYmFyLW1haW5cIiB8fFxyXG5cdFx0XHRcdFx0cmVzdWx0Lml0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicHJvZ3Jlc3NcIilcclxuXHRcdFx0KTtcclxuXHRcdFx0ZXhwZWN0KHByb2dyZXNzUmVzdWx0KS50b0JlRGVmaW5lZCgpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGVzdChcInNob3VsZCBzZWFyY2ggYnkgZGVzY3JpcHRpb25cIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zdCByZXN1bHRzID0gaW5kZXhlci5zZWFyY2goXCJ0b2dnbGVcIik7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlNlYXJjaCByZXN1bHRzIGZvciAndG9nZ2xlJzpcIiwgcmVzdWx0cy5sZW5ndGgpO1xyXG5cdFx0XHRyZXN1bHRzLmZvckVhY2goKHJlc3VsdCkgPT4ge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFxyXG5cdFx0XHRcdFx0YC0gJHtyZXN1bHQuaXRlbS5uYW1lfSAoJHtyZXN1bHQubWF0Y2hUeXBlfSwgc2NvcmU6ICR7cmVzdWx0LnNjb3JlfSlgXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0XHRpZiAocmVzdWx0Lml0ZW0uZGVzY3JpcHRpb24pIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFxyXG5cdFx0XHRcdFx0XHRgICBEZXNjcmlwdGlvbjogJHtyZXN1bHQuaXRlbS5kZXNjcmlwdGlvbi5zdWJzdHJpbmcoXHJcblx0XHRcdFx0XHRcdFx0MCxcclxuXHRcdFx0XHRcdFx0XHQxMDBcclxuXHRcdFx0XHRcdFx0KX0uLi5gXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRleHBlY3QocmVzdWx0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgc2VhcmNoIGJ5IGtleXdvcmRzXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwiY2hlY2tib3hcIik7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlNlYXJjaCByZXN1bHRzIGZvciAnY2hlY2tib3gnOlwiLCByZXN1bHRzLmxlbmd0aCk7XHJcblx0XHRcdHJlc3VsdHMuZm9yRWFjaCgocmVzdWx0KSA9PiB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXHJcblx0XHRcdFx0XHRgLSAke3Jlc3VsdC5pdGVtLm5hbWV9ICgke3Jlc3VsdC5tYXRjaFR5cGV9LCBzY29yZTogJHtyZXN1bHQuc2NvcmV9KWBcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGAgIEtleXdvcmRzOiAke3Jlc3VsdC5pdGVtLmtleXdvcmRzLmpvaW4oXCIsIFwiKX1gKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRleHBlY3QocmVzdWx0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgcHJpb3JpdGl6ZSBuYW1lIG1hdGNoZXMgb3ZlciBkZXNjcmlwdGlvbiBtYXRjaGVzXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwiZmlsdGVyXCIpO1xyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCJTZWFyY2ggcmVzdWx0cyBmb3IgJ2ZpbHRlcicgd2l0aCBzY29yZXM6XCIpO1xyXG5cdFx0XHRyZXN1bHRzLmZvckVhY2goKHJlc3VsdCkgPT4ge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFxyXG5cdFx0XHRcdFx0YC0gJHtyZXN1bHQuaXRlbS5uYW1lfSAoJHtyZXN1bHQubWF0Y2hUeXBlfSwgc2NvcmU6ICR7cmVzdWx0LnNjb3JlfSlgXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRleHBlY3QocmVzdWx0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuXHJcblx0XHRcdC8vIEZpbmQgbmFtZSBtYXRjaGVzIGFuZCBkZXNjcmlwdGlvbiBtYXRjaGVzXHJcblx0XHRcdGNvbnN0IG5hbWVNYXRjaGVzID0gcmVzdWx0cy5maWx0ZXIoKHIpID0+IHIubWF0Y2hUeXBlID09PSBcIm5hbWVcIik7XHJcblx0XHRcdGNvbnN0IGRlc2NyaXB0aW9uTWF0Y2hlcyA9IHJlc3VsdHMuZmlsdGVyKFxyXG5cdFx0XHRcdChyKSA9PiByLm1hdGNoVHlwZSA9PT0gXCJkZXNjcmlwdGlvblwiXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRpZiAobmFtZU1hdGNoZXMubGVuZ3RoID4gMCAmJiBkZXNjcmlwdGlvbk1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdC8vIE5hbWUgbWF0Y2hlcyBzaG91bGQgaGF2ZSBoaWdoZXIgc2NvcmVzXHJcblx0XHRcdFx0Y29uc3QgaGlnaGVzdE5hbWVTY29yZSA9IE1hdGgubWF4KFxyXG5cdFx0XHRcdFx0Li4ubmFtZU1hdGNoZXMubWFwKChyKSA9PiByLnNjb3JlKVxyXG5cdFx0XHRcdCk7XHJcblx0XHRcdFx0Y29uc3QgaGlnaGVzdERlc2NTY29yZSA9IE1hdGgubWF4KFxyXG5cdFx0XHRcdFx0Li4uZGVzY3JpcHRpb25NYXRjaGVzLm1hcCgocikgPT4gci5zY29yZSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGV4cGVjdChoaWdoZXN0TmFtZVNjb3JlKS50b0JlR3JlYXRlclRoYW4oaGlnaGVzdERlc2NTY29yZSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgcmV0dXJuIGVtcHR5IHJlc3VsdHMgZm9yIGVtcHR5IHF1ZXJ5XCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwiXCIpO1xyXG5cdFx0XHRleHBlY3QocmVzdWx0cy5sZW5ndGgpLnRvQmUoMCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHR0ZXN0KFwic2hvdWxkIHJldHVybiBlbXB0eSByZXN1bHRzIGZvciB2ZXJ5IHNob3J0IHF1ZXJ5XCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwiYVwiKTtcclxuXHRcdFx0ZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50b0JlKDApO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGVzdChcInNob3VsZCByZXR1cm4gcmVzdWx0cyBmb3IgMisgY2hhcmFjdGVyIHF1ZXJ5XCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwicHJcIik7XHJcblx0XHRcdGV4cGVjdChyZXN1bHRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGVzdChcInNob3VsZCBsaW1pdCByZXN1bHRzXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwidGFza1wiKTtcclxuXHRcdFx0Y29uc29sZS5sb2coYEZvdW5kICR7cmVzdWx0cy5sZW5ndGh9IHJlc3VsdHMgZm9yICd0YXNrJ2ApO1xyXG5cdFx0XHRleHBlY3QocmVzdWx0cy5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTApOyAvLyBEZWZhdWx0IGxpbWl0XHJcblx0XHR9KTtcclxuXHJcblx0XHR0ZXN0KFwic2hvdWxkIGhhbmRsZSBjYXNlIGluc2Vuc2l0aXZlIHNlYXJjaFwiLCAoKSA9PiB7XHJcblx0XHRcdGNvbnN0IGxvd2VyUmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwicHJvZ3Jlc3NcIik7XHJcblx0XHRcdGNvbnN0IHVwcGVyUmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwiUFJPR1JFU1NcIik7XHJcblx0XHRcdGNvbnN0IG1peGVkUmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwiUHJvZ3Jlc3NcIik7XHJcblxyXG5cdFx0XHRleHBlY3QobG93ZXJSZXN1bHRzLmxlbmd0aCkudG9CZSh1cHBlclJlc3VsdHMubGVuZ3RoKTtcclxuXHRcdFx0ZXhwZWN0KGxvd2VyUmVzdWx0cy5sZW5ndGgpLnRvQmUobWl4ZWRSZXN1bHRzLmxlbmd0aCk7XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHJcblx0ZGVzY3JpYmUoXCJUcmFuc2xhdGlvbiBJbnRlZ3JhdGlvblwiLCAoKSA9PiB7XHJcblx0XHR0ZXN0KFwic2hvdWxkIGNhbGwgdHJhbnNsYXRpb24gZnVuY3Rpb24gZm9yIHNldHRpbmcgbmFtZXNcIiwgKCkgPT4ge1xyXG5cdFx0XHRpbmRleGVyLnNlYXJjaChcInByb2dyZXNzXCIpO1xyXG5cclxuXHRcdFx0Ly8gU2hvdWxkIGhhdmUgY2FsbGVkIHQoKSBmb3IgdHJhbnNsYXRpbmcgc2V0dGluZyBuYW1lc1xyXG5cdFx0XHRleHBlY3QobW9ja1QpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuXHJcblx0XHRcdC8vIENoZWNrIGlmIGl0IHdhcyBjYWxsZWQgd2l0aCBleHBlY3RlZCB0cmFuc2xhdGlvbiBrZXlzXHJcblx0XHRcdGNvbnN0IGNhbGxzID0gbW9ja1QubW9jay5jYWxscy5tYXAoKGNhbGw6IGFueSkgPT4gY2FsbFswXSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiVHJhbnNsYXRpb24gY2FsbHM6XCIsIGNhbGxzLnNsaWNlKDAsIDEwKSk7IC8vIFNob3cgZmlyc3QgMTAgY2FsbHNcclxuXHJcblx0XHRcdGV4cGVjdChjYWxscykudG9Db250YWluKFwiUHJvZ3Jlc3MgYmFyXCIpO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdGRlc2NyaWJlKFwiRWRnZSBDYXNlc1wiLCAoKSA9PiB7XHJcblx0XHR0ZXN0KFwic2hvdWxkIGhhbmRsZSBzcGVjaWFsIGNoYXJhY3RlcnMgaW4gc2VhcmNoXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwidGFzay1maWx0ZXJcIik7XHJcblx0XHRcdGV4cGVjdChyZXN1bHRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgaGFuZGxlIHVuaWNvZGUgY2hhcmFjdGVyc1wiLCAoKSA9PiB7XHJcblx0XHRcdGNvbnN0IHJlc3VsdHMgPSBpbmRleGVyLnNlYXJjaChcIuiuvue9rlwiKTtcclxuXHRcdFx0ZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGVzdChcInNob3VsZCBoYW5kbGUgbnVtYmVycyBpbiBzZWFyY2hcIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zdCByZXN1bHRzID0gaW5kZXhlci5zZWFyY2goXCIxMDBcIik7XHJcblx0XHRcdGV4cGVjdChyZXN1bHRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cclxuXHRkZXNjcmliZShcIlBlcmZvcm1hbmNlXCIsICgpID0+IHtcclxuXHRcdHRlc3QoXCJzaG91bGQgYnVpbGQgaW5kZXggcXVpY2tseVwiLCAoKSA9PiB7XHJcblx0XHRcdGNvbnN0IHN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcblx0XHRcdGluZGV4ZXIuaW5pdGlhbGl6ZSgpO1xyXG5cdFx0XHRjb25zdCBlbmQgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuXHJcblx0XHRcdGNvbnN0IGJ1aWxkVGltZSA9IGVuZCAtIHN0YXJ0O1xyXG5cdFx0XHRjb25zb2xlLmxvZyhgSW5kZXggYnVpbGQgdGltZTogJHtidWlsZFRpbWUudG9GaXhlZCgyKX1tc2ApO1xyXG5cdFx0XHRleHBlY3QoYnVpbGRUaW1lKS50b0JlTGVzc1RoYW4oNTApOyAvLyBTaG91bGQgYmUgdW5kZXIgNTBtc1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGVzdChcInNob3VsZCBzZWFyY2ggcXVpY2tseVwiLCAoKSA9PiB7XHJcblx0XHRcdGluZGV4ZXIuaW5pdGlhbGl6ZSgpOyAvLyBQcmUtaW5pdGlhbGl6ZVxyXG5cclxuXHRcdFx0Y29uc3Qgc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwicHJvZ3Jlc3NcIik7XHJcblx0XHRcdGNvbnN0IGVuZCA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG5cclxuXHRcdFx0Y29uc3Qgc2VhcmNoVGltZSA9IGVuZCAtIHN0YXJ0O1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcclxuXHRcdFx0XHRgU2VhcmNoIHRpbWU6ICR7c2VhcmNoVGltZS50b0ZpeGVkKDIpfW1zIGZvciAke1xyXG5cdFx0XHRcdFx0cmVzdWx0cy5sZW5ndGhcclxuXHRcdFx0XHR9IHJlc3VsdHNgXHJcblx0XHRcdCk7XHJcblx0XHRcdGV4cGVjdChzZWFyY2hUaW1lKS50b0JlTGVzc1RoYW4oMTApOyAvLyBTaG91bGQgYmUgdW5kZXIgMTBtc1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdGRlc2NyaWJlKFwiU3BlY2lmaWMgU2V0dGluZyBUZXN0c1wiLCAoKSA9PiB7XHJcblx0XHR0ZXN0KFwic2hvdWxkIGZpbmQgJ0VuYWJsZSBUYXNrIEZpbHRlcicgc2V0dGluZ1wiLCAoKSA9PiB7XHJcblx0XHRcdGNvbnN0IHJlc3VsdHMgPSBpbmRleGVyLnNlYXJjaChcImVuYWJsZSB0YXNrIGZpbHRlclwiKTtcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiU2VhcmNoaW5nIGZvciAnZW5hYmxlIHRhc2sgZmlsdGVyJzpcIik7XHJcblx0XHRcdHJlc3VsdHMuZm9yRWFjaCgocmVzdWx0KSA9PiB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coYC0gJHtyZXN1bHQuaXRlbS5uYW1lfSAoSUQ6ICR7cmVzdWx0Lml0ZW0uaWR9KWApO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGNvbnN0IGV4YWN0TWF0Y2ggPSByZXN1bHRzLmZpbmQoXHJcblx0XHRcdFx0KHIpID0+IHIuaXRlbS5pZCA9PT0gXCJlbmFibGUtdGFzay1maWx0ZXJcIlxyXG5cdFx0XHQpO1xyXG5cdFx0XHRleHBlY3QoZXhhY3RNYXRjaCkudG9CZURlZmluZWQoKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRlc3QoXCJzaG91bGQgZmluZCBwcm9ncmVzcyBiYXIgc2V0dGluZ3NcIiwgKCkgPT4ge1xyXG5cdFx0XHRjb25zdCByZXN1bHRzID0gaW5kZXhlci5zZWFyY2goXCJwcm9ncmVzcyBiYXJcIik7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlNlYXJjaGluZyBmb3IgJ3Byb2dyZXNzIGJhcic6XCIpO1xyXG5cdFx0XHRyZXN1bHRzLmZvckVhY2goKHJlc3VsdCkgPT4ge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGAtICR7cmVzdWx0Lml0ZW0ubmFtZX0gKElEOiAke3Jlc3VsdC5pdGVtLmlkfSlgKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRjb25zdCBwcm9ncmVzc0Jhck1haW4gPSByZXN1bHRzLmZpbmQoXHJcblx0XHRcdFx0KHIpID0+IHIuaXRlbS5pZCA9PT0gXCJwcm9ncmVzcy1iYXItbWFpblwiXHJcblx0XHRcdCk7XHJcblx0XHRcdGV4cGVjdChwcm9ncmVzc0Jhck1haW4pLnRvQmVEZWZpbmVkKCk7XHJcblx0XHRcdGV4cGVjdChwcm9ncmVzc0Jhck1haW4/Lm1hdGNoVHlwZSkudG9CZShcIm5hbWVcIik7XHJcblx0XHR9KTtcclxuXHJcblx0XHR0ZXN0KFwic2hvdWxkIGZpbmQgc2V0dGluZ3MgYnkgcGFydGlhbCBuYW1lXCIsICgpID0+IHtcclxuXHRcdFx0Y29uc3QgcmVzdWx0cyA9IGluZGV4ZXIuc2VhcmNoKFwid29ya2Zsb3dcIik7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIlNlYXJjaGluZyBmb3IgJ3dvcmtmbG93JzpcIik7XHJcblx0XHRcdHJlc3VsdHMuZm9yRWFjaCgocmVzdWx0KSA9PiB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coYC0gJHtyZXN1bHQuaXRlbS5uYW1lfSAoSUQ6ICR7cmVzdWx0Lml0ZW0uaWR9KWApO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGV4cGVjdChyZXN1bHRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG5cclxuXHRcdFx0Ly8gU2hvdWxkIGZpbmQgd29ya2Zsb3ctcmVsYXRlZCBzZXR0aW5nc1xyXG5cdFx0XHRjb25zdCB3b3JrZmxvd1NldHRpbmdzID0gcmVzdWx0cy5maWx0ZXIoXHJcblx0XHRcdFx0KHIpID0+XHJcblx0XHRcdFx0XHRyLml0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwid29ya2Zsb3dcIikgfHxcclxuXHRcdFx0XHRcdHIuaXRlbS50YWJJZCA9PT0gXCJ3b3JrZmxvd1wiXHJcblx0XHRcdCk7XHJcblx0XHRcdGV4cGVjdCh3b3JrZmxvd1NldHRpbmdzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0pO1xyXG4iXX0=