import { __awaiter } from "tslib";
import { Notice, setIcon, Setting } from "obsidian";
import { t } from "@/translations/helper";
import { ConfirmModal } from "@/components/ui/modals/ConfirmModal";
import { DEFAULT_SETTINGS } from "@/common/setting-definition";
import { ONBOARDING_VIEW_TYPE } from "@/components/features/onboarding/OnboardingView";
export function renderAboutSettingsTab(settingTab, containerEl) {
    new Setting(containerEl).setName(t("About") + " Task Genius").setHeading();
    new Setting(containerEl)
        .setName(t("Version"))
        .setDesc(`Task Genius v${settingTab.plugin.manifest.version}`);
    new Setting(containerEl)
        .setName(t("Changelog"))
        .setDesc(t("Show changelog after plugin updates"))
        .addToggle((toggle) => {
        toggle
            .setValue(settingTab.plugin.settings.changelog.enabled)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            settingTab.plugin.settings.changelog.enabled = value;
            yield settingTab.plugin.saveSettings();
        }));
    });
    new Setting(containerEl)
        .setName(t("Donate"))
        .setDesc(t("If you like this plugin, consider donating to support continued development:"))
        .addButton((bt) => {
        bt.buttonEl.outerHTML = `<a href="https://www.buymeacoffee.com/boninall"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=boninall&button_colour=6495ED&font_colour=ffffff&font_family=Inter&outline_colour=000000&coffee_colour=FFDD00"></a>`;
    });
    new Setting(containerEl)
        .setName(t("Documentation"))
        .setDesc(t("View the documentation for this plugin"))
        .addButton((button) => {
        button.setButtonText(t("Open Documentation")).onClick(() => {
            window.open("https://taskgenius.md/docs/getting-started");
        });
    });
    // Onboarding/Help Section
    new Setting(containerEl)
        .setName(t("Onboarding"))
        .setDesc(t("Restart the welcome guide and setup wizard"))
        .addButton((button) => {
        button
            .setButtonText(t("Restart Onboarding"))
            .setIcon("graduation-cap")
            .onClick(() => __awaiter(this, void 0, void 0, function* () {
            // Reset onboarding status
            yield settingTab.plugin.onboardingConfigManager.resetOnboarding();
            if (typeof settingTab.setting.close === "function") {
                settingTab.setting.close();
                settingTab.plugin.app.workspace.getLeaf().setViewState({
                    type: ONBOARDING_VIEW_TYPE,
                });
            }
        }));
    });
    new Setting(containerEl)
        .setName(t("Reset All Settings"))
        .setDesc(t("Reset all settings to their default values"))
        .addButton((button) => {
        button
            .setButtonText(t("Reset Settings"))
            .setIcon("refresh-cw")
            .setWarning()
            .onClick(() => {
            new ConfirmModal(settingTab.plugin, {
                title: t("Reset All Settings"),
                message: t("Are you sure you want to reset all settings to their default values?\n\nThis action cannot be undone."),
                confirmText: t("Reset"),
                cancelText: t("Cancel"),
                onConfirm: (confirmed) => __awaiter(this, void 0, void 0, function* () {
                    if (confirmed) {
                        // Reset all settings to defaults
                        settingTab.plugin.settings = Object.assign({}, DEFAULT_SETTINGS);
                        yield settingTab.plugin.saveSettings();
                        // Refresh the settings display
                        settingTab.display();
                        // Show success notice
                        new Notice(t("All settings have been reset to their default values"));
                    }
                }),
            }).open();
        });
    });
    new Setting(containerEl)
        .setName(t("Discord"))
        .setDesc(t("Chat with us"))
        .addButton((button) => {
        button.setButtonText(t("Open Discord")).onClick(() => {
            window.open("https://discord.gg/ARR2rHHX6b");
        });
    });
    const descFragment = document.createDocumentFragment();
    descFragment.createEl("span", {
        cls: "tg-icons-desc",
    }, (el) => {
        el.setText(t("Task Genius icons are designed by"));
    });
    descFragment.createEl("a", {
        href: "https://github.com/jsmorabito",
        attr: {
            target: "_blank",
            rel: "noopener noreferrer",
        },
    }, (el) => {
        el.setText(" @Jsmorabito");
    });
    // Task Genius Icons Settings
    new Setting(containerEl)
        .setName(t("Task Genius Icons"))
        .setDesc(descFragment)
        .setHeading();
    containerEl.createDiv({
        cls: "tg-icons-container",
    }, (el) => {
        for (const status of Object.keys(settingTab.plugin.settings.taskStatuses)) {
            const iconEl = el.createSpan();
            setIcon(iconEl, status);
        }
        const tgIconEl = el.createSpan();
        setIcon(tgIconEl, "task-genius");
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWJvdXRTZXR0aW5nc1RhYi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkFib3V0U2V0dGluZ3NUYWIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUVwRCxPQUFPLEVBQUUsQ0FBQyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDMUMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHFDQUFxQyxDQUFDO0FBQ25FLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQy9ELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLGlEQUFpRCxDQUFDO0FBRXZGLE1BQU0sVUFBVSxzQkFBc0IsQ0FDckMsVUFBcUMsRUFDckMsV0FBd0I7SUFFeEIsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxjQUFjLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUUzRSxJQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUM7U0FDdEIsT0FBTyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUNyQixPQUFPLENBQUMsZ0JBQWdCLFVBQVUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFFaEUsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDO1NBQ3RCLE9BQU8sQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDdkIsT0FBTyxDQUFDLENBQUMsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO1NBQ2pELFNBQVMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO1FBQ3JCLE1BQU07YUFDSixRQUFRLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQzthQUN0RCxRQUFRLENBQUMsQ0FBTyxLQUFLLEVBQUUsRUFBRTtZQUN6QixVQUFVLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNyRCxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDeEMsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUosSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDO1NBQ3RCLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDcEIsT0FBTyxDQUNQLENBQUMsQ0FDQSw4RUFBOEUsQ0FDOUUsQ0FDRDtTQUNBLFNBQVMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFO1FBQ2pCLEVBQUUsQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLHlQQUF5UCxDQUFDO0lBQ25SLENBQUMsQ0FBQyxDQUFDO0lBRUosSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDO1NBQ3RCLE9BQU8sQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUM7U0FDM0IsT0FBTyxDQUFDLENBQUMsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO1NBQ3BELFNBQVMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO1FBQ3JCLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFO1lBQzFELE1BQU0sQ0FBQyxJQUFJLENBQUMsNENBQTRDLENBQUMsQ0FBQztRQUMzRCxDQUFDLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0lBRUosMEJBQTBCO0lBQzFCLElBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQztTQUN0QixPQUFPLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQ3hCLE9BQU8sQ0FBQyxDQUFDLENBQUMsNENBQTRDLENBQUMsQ0FBQztTQUN4RCxTQUFTLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRTtRQUNyQixNQUFNO2FBQ0osYUFBYSxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO2FBQ3RDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQzthQUN6QixPQUFPLENBQUMsR0FBUyxFQUFFO1lBQ25CLDBCQUEwQjtZQUMxQixNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQUMsdUJBQXVCLENBQUMsZUFBZSxFQUFFLENBQUM7WUFFbEUsSUFBSSxPQUFRLFVBQWtCLENBQUMsT0FBTyxDQUFDLEtBQUssS0FBSyxVQUFVLEVBQUU7Z0JBQzNELFVBQWtCLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO2dCQUVwQyxVQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsWUFBWSxDQUFDO29CQUN0RCxJQUFJLEVBQUUsb0JBQW9CO2lCQUMxQixDQUFDLENBQUM7YUFDSDtRQUNGLENBQUMsQ0FBQSxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVKLElBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQztTQUN0QixPQUFPLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUM7U0FDaEMsT0FBTyxDQUFDLENBQUMsQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1NBQ3hELFNBQVMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO1FBQ3JCLE1BQU07YUFDSixhQUFhLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLENBQUM7YUFDbEMsT0FBTyxDQUFDLFlBQVksQ0FBQzthQUNyQixVQUFVLEVBQUU7YUFDWixPQUFPLENBQUMsR0FBRyxFQUFFO1lBQ2IsSUFBSSxZQUFZLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRTtnQkFDbkMsS0FBSyxFQUFFLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDOUIsT0FBTyxFQUFFLENBQUMsQ0FDVCx1R0FBdUcsQ0FDdkc7Z0JBQ0QsV0FBVyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQ3ZCLFVBQVUsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDO2dCQUN2QixTQUFTLEVBQUUsQ0FBTyxTQUFTLEVBQUUsRUFBRTtvQkFDOUIsSUFBSSxTQUFTLEVBQUU7d0JBQ2QsaUNBQWlDO3dCQUNqQyxVQUFVLENBQUMsTUFBTSxDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUN6QyxFQUFFLEVBQ0YsZ0JBQWdCLENBQ2hCLENBQUM7d0JBQ0YsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUV2QywrQkFBK0I7d0JBQy9CLFVBQVUsQ0FBQyxPQUFPLEVBQUUsQ0FBQzt3QkFFckIsc0JBQXNCO3dCQUN0QixJQUFJLE1BQU0sQ0FDVCxDQUFDLENBQ0Esc0RBQXNELENBQ3RELENBQ0QsQ0FBQztxQkFDRjtnQkFDRixDQUFDLENBQUE7YUFDRCxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDWCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUosSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDO1NBQ3RCLE9BQU8sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDckIsT0FBTyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUMxQixTQUFTLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRTtRQUNyQixNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUU7WUFDcEQsTUFBTSxDQUFDLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1FBQzlDLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7SUFFSixNQUFNLFlBQVksR0FBRyxRQUFRLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztJQUN2RCxZQUFZLENBQUMsUUFBUSxDQUNwQixNQUFNLEVBQ047UUFDQyxHQUFHLEVBQUUsZUFBZTtLQUNwQixFQUNELENBQUMsRUFBRSxFQUFFLEVBQUU7UUFDTixFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDLENBQUM7SUFDcEQsQ0FBQyxDQUNELENBQUM7SUFDRixZQUFZLENBQUMsUUFBUSxDQUNwQixHQUFHLEVBQ0g7UUFDQyxJQUFJLEVBQUUsK0JBQStCO1FBQ3JDLElBQUksRUFBRTtZQUNMLE1BQU0sRUFBRSxRQUFRO1lBQ2hCLEdBQUcsRUFBRSxxQkFBcUI7U0FDMUI7S0FDRCxFQUNELENBQUMsRUFBRSxFQUFFLEVBQUU7UUFDTixFQUFFLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQzVCLENBQUMsQ0FDRCxDQUFDO0lBRUYsNkJBQTZCO0lBQzdCLElBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQztTQUN0QixPQUFPLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUM7U0FDL0IsT0FBTyxDQUFDLFlBQVksQ0FBQztTQUNyQixVQUFVLEVBQUUsQ0FBQztJQUVmLFdBQVcsQ0FBQyxTQUFTLENBQ3BCO1FBQ0MsR0FBRyxFQUFFLG9CQUFvQjtLQUN6QixFQUNELENBQUMsRUFBRSxFQUFFLEVBQUU7UUFDTixLQUFLLE1BQU0sTUFBTSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQy9CLFVBQVUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FDdkMsRUFBRTtZQUNGLE1BQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUMvQixPQUFPLENBQ04sTUFBTSxFQUNOLE1BS1ksQ0FDWixDQUFDO1NBQ0Y7UUFDRCxNQUFNLFFBQVEsR0FBRyxFQUFFLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDakMsT0FBTyxDQUFDLFFBQVEsRUFBRSxhQUFhLENBQUMsQ0FBQztJQUNsQyxDQUFDLENBQ0QsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOb3RpY2UsIHNldEljb24sIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgVGFza1Byb2dyZXNzQmFyU2V0dGluZ1RhYiB9IGZyb20gXCJAL3NldHRpbmdcIjtcclxuaW1wb3J0IHsgdCB9IGZyb20gXCJAL3RyYW5zbGF0aW9ucy9oZWxwZXJcIjtcclxuaW1wb3J0IHsgQ29uZmlybU1vZGFsIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9tb2RhbHMvQ29uZmlybU1vZGFsXCI7XHJcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwiQC9jb21tb24vc2V0dGluZy1kZWZpbml0aW9uXCI7XHJcbmltcG9ydCB7IE9OQk9BUkRJTkdfVklFV19UWVBFIH0gZnJvbSBcIkAvY29tcG9uZW50cy9mZWF0dXJlcy9vbmJvYXJkaW5nL09uYm9hcmRpbmdWaWV3XCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyQWJvdXRTZXR0aW5nc1RhYihcclxuXHRzZXR0aW5nVGFiOiBUYXNrUHJvZ3Jlc3NCYXJTZXR0aW5nVGFiLFxyXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudFxyXG4pIHtcclxuXHRuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSh0KFwiQWJvdXRcIikgKyBcIiBUYXNrIEdlbml1c1wiKS5zZXRIZWFkaW5nKCk7XHJcblxyXG5cdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0LnNldE5hbWUodChcIlZlcnNpb25cIikpXHJcblx0XHQuc2V0RGVzYyhgVGFzayBHZW5pdXMgdiR7c2V0dGluZ1RhYi5wbHVnaW4ubWFuaWZlc3QudmVyc2lvbn1gKTtcclxuXHJcblx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHQuc2V0TmFtZSh0KFwiQ2hhbmdlbG9nXCIpKVxyXG5cdFx0LnNldERlc2ModChcIlNob3cgY2hhbmdlbG9nIGFmdGVyIHBsdWdpbiB1cGRhdGVzXCIpKVxyXG5cdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5nVGFiLnBsdWdpbi5zZXR0aW5ncy5jaGFuZ2Vsb2cuZW5hYmxlZClcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRzZXR0aW5nVGFiLnBsdWdpbi5zZXR0aW5ncy5jaGFuZ2Vsb2cuZW5hYmxlZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgc2V0dGluZ1RhYi5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHQuc2V0TmFtZSh0KFwiRG9uYXRlXCIpKVxyXG5cdFx0LnNldERlc2MoXHJcblx0XHRcdHQoXHJcblx0XHRcdFx0XCJJZiB5b3UgbGlrZSB0aGlzIHBsdWdpbiwgY29uc2lkZXIgZG9uYXRpbmcgdG8gc3VwcG9ydCBjb250aW51ZWQgZGV2ZWxvcG1lbnQ6XCJcclxuXHRcdFx0KVxyXG5cdFx0KVxyXG5cdFx0LmFkZEJ1dHRvbigoYnQpID0+IHtcclxuXHRcdFx0YnQuYnV0dG9uRWwub3V0ZXJIVE1MID0gYDxhIGhyZWY9XCJodHRwczovL3d3dy5idXltZWFjb2ZmZWUuY29tL2JvbmluYWxsXCI+PGltZyBzcmM9XCJodHRwczovL2ltZy5idXltZWFjb2ZmZWUuY29tL2J1dHRvbi1hcGkvP3RleHQ9QnV5IG1lIGEgY29mZmVlJmVtb2ppPSZzbHVnPWJvbmluYWxsJmJ1dHRvbl9jb2xvdXI9NjQ5NUVEJmZvbnRfY29sb3VyPWZmZmZmZiZmb250X2ZhbWlseT1JbnRlciZvdXRsaW5lX2NvbG91cj0wMDAwMDAmY29mZmVlX2NvbG91cj1GRkREMDBcIj48L2E+YDtcclxuXHRcdH0pO1xyXG5cclxuXHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdC5zZXROYW1lKHQoXCJEb2N1bWVudGF0aW9uXCIpKVxyXG5cdFx0LnNldERlc2ModChcIlZpZXcgdGhlIGRvY3VtZW50YXRpb24gZm9yIHRoaXMgcGx1Z2luXCIpKVxyXG5cdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcblx0XHRcdGJ1dHRvbi5zZXRCdXR0b25UZXh0KHQoXCJPcGVuIERvY3VtZW50YXRpb25cIikpLm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdHdpbmRvdy5vcGVuKFwiaHR0cHM6Ly90YXNrZ2VuaXVzLm1kL2RvY3MvZ2V0dGluZy1zdGFydGVkXCIpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHQvLyBPbmJvYXJkaW5nL0hlbHAgU2VjdGlvblxyXG5cdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0LnNldE5hbWUodChcIk9uYm9hcmRpbmdcIikpXHJcblx0XHQuc2V0RGVzYyh0KFwiUmVzdGFydCB0aGUgd2VsY29tZSBndWlkZSBhbmQgc2V0dXAgd2l6YXJkXCIpKVxyXG5cdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcblx0XHRcdGJ1dHRvblxyXG5cdFx0XHRcdC5zZXRCdXR0b25UZXh0KHQoXCJSZXN0YXJ0IE9uYm9hcmRpbmdcIikpXHJcblx0XHRcdFx0LnNldEljb24oXCJncmFkdWF0aW9uLWNhcFwiKVxyXG5cdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdC8vIFJlc2V0IG9uYm9hcmRpbmcgc3RhdHVzXHJcblx0XHRcdFx0XHRhd2FpdCBzZXR0aW5nVGFiLnBsdWdpbi5vbmJvYXJkaW5nQ29uZmlnTWFuYWdlci5yZXNldE9uYm9hcmRpbmcoKTtcclxuXHJcblx0XHRcdFx0XHRpZiAodHlwZW9mIChzZXR0aW5nVGFiIGFzIGFueSkuc2V0dGluZy5jbG9zZSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRcdFx0XHRcdChzZXR0aW5nVGFiIGFzIGFueSkuc2V0dGluZy5jbG9zZSgpO1xyXG5cclxuXHRcdFx0XHRcdFx0c2V0dGluZ1RhYi5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkuc2V0Vmlld1N0YXRlKHtcclxuXHRcdFx0XHRcdFx0XHR0eXBlOiBPTkJPQVJESU5HX1ZJRVdfVFlQRSxcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHQuc2V0TmFtZSh0KFwiUmVzZXQgQWxsIFNldHRpbmdzXCIpKVxyXG5cdFx0LnNldERlc2ModChcIlJlc2V0IGFsbCBzZXR0aW5ncyB0byB0aGVpciBkZWZhdWx0IHZhbHVlc1wiKSlcclxuXHRcdC5hZGRCdXR0b24oKGJ1dHRvbikgPT4ge1xyXG5cdFx0XHRidXR0b25cclxuXHRcdFx0XHQuc2V0QnV0dG9uVGV4dCh0KFwiUmVzZXQgU2V0dGluZ3NcIikpXHJcblx0XHRcdFx0LnNldEljb24oXCJyZWZyZXNoLWN3XCIpXHJcblx0XHRcdFx0LnNldFdhcm5pbmcoKVxyXG5cdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHRcdG5ldyBDb25maXJtTW9kYWwoc2V0dGluZ1RhYi5wbHVnaW4sIHtcclxuXHRcdFx0XHRcdFx0dGl0bGU6IHQoXCJSZXNldCBBbGwgU2V0dGluZ3NcIiksXHJcblx0XHRcdFx0XHRcdG1lc3NhZ2U6IHQoXHJcblx0XHRcdFx0XHRcdFx0XCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVzZXQgYWxsIHNldHRpbmdzIHRvIHRoZWlyIGRlZmF1bHQgdmFsdWVzP1xcblxcblRoaXMgYWN0aW9uIGNhbm5vdCBiZSB1bmRvbmUuXCJcclxuXHRcdFx0XHRcdFx0KSxcclxuXHRcdFx0XHRcdFx0Y29uZmlybVRleHQ6IHQoXCJSZXNldFwiKSxcclxuXHRcdFx0XHRcdFx0Y2FuY2VsVGV4dDogdChcIkNhbmNlbFwiKSxcclxuXHRcdFx0XHRcdFx0b25Db25maXJtOiBhc3luYyAoY29uZmlybWVkKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGNvbmZpcm1lZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVzZXQgYWxsIHNldHRpbmdzIHRvIGRlZmF1bHRzXHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5nVGFiLnBsdWdpbi5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oXHJcblx0XHRcdFx0XHRcdFx0XHRcdHt9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRERUZBVUxUX1NFVFRJTkdTXHJcblx0XHRcdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgc2V0dGluZ1RhYi5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCB0aGUgc2V0dGluZ3MgZGlzcGxheVxyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ1RhYi5kaXNwbGF5KCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gU2hvdyBzdWNjZXNzIG5vdGljZVxyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShcclxuXHRcdFx0XHRcdFx0XHRcdFx0dChcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcIkFsbCBzZXR0aW5ncyBoYXZlIGJlZW4gcmVzZXQgdG8gdGhlaXIgZGVmYXVsdCB2YWx1ZXNcIlxyXG5cdFx0XHRcdFx0XHRcdFx0XHQpXHJcblx0XHRcdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdH0pLm9wZW4oKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdC5zZXROYW1lKHQoXCJEaXNjb3JkXCIpKVxyXG5cdFx0LnNldERlc2ModChcIkNoYXQgd2l0aCB1c1wiKSlcclxuXHRcdC5hZGRCdXR0b24oKGJ1dHRvbikgPT4ge1xyXG5cdFx0XHRidXR0b24uc2V0QnV0dG9uVGV4dCh0KFwiT3BlbiBEaXNjb3JkXCIpKS5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHR3aW5kb3cub3BlbihcImh0dHBzOi8vZGlzY29yZC5nZy9BUlIyckhIWDZiXCIpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRjb25zdCBkZXNjRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFxyXG5cdFx0XCJzcGFuXCIsXHJcblx0XHR7XHJcblx0XHRcdGNsczogXCJ0Zy1pY29ucy1kZXNjXCIsXHJcblx0XHR9LFxyXG5cdFx0KGVsKSA9PiB7XHJcblx0XHRcdGVsLnNldFRleHQodChcIlRhc2sgR2VuaXVzIGljb25zIGFyZSBkZXNpZ25lZCBieVwiKSk7XHJcblx0XHR9XHJcblx0KTtcclxuXHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXHJcblx0XHRcImFcIixcclxuXHRcdHtcclxuXHRcdFx0aHJlZjogXCJodHRwczovL2dpdGh1Yi5jb20vanNtb3JhYml0b1wiLFxyXG5cdFx0XHRhdHRyOiB7XHJcblx0XHRcdFx0dGFyZ2V0OiBcIl9ibGFua1wiLFxyXG5cdFx0XHRcdHJlbDogXCJub29wZW5lciBub3JlZmVycmVyXCIsXHJcblx0XHRcdH0sXHJcblx0XHR9LFxyXG5cdFx0KGVsKSA9PiB7XHJcblx0XHRcdGVsLnNldFRleHQoXCIgQEpzbW9yYWJpdG9cIik7XHJcblx0XHR9XHJcblx0KTtcclxuXHJcblx0Ly8gVGFzayBHZW5pdXMgSWNvbnMgU2V0dGluZ3NcclxuXHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdC5zZXROYW1lKHQoXCJUYXNrIEdlbml1cyBJY29uc1wiKSlcclxuXHRcdC5zZXREZXNjKGRlc2NGcmFnbWVudClcclxuXHRcdC5zZXRIZWFkaW5nKCk7XHJcblxyXG5cdGNvbnRhaW5lckVsLmNyZWF0ZURpdihcclxuXHRcdHtcclxuXHRcdFx0Y2xzOiBcInRnLWljb25zLWNvbnRhaW5lclwiLFxyXG5cdFx0fSxcclxuXHRcdChlbCkgPT4ge1xyXG5cdFx0XHRmb3IgKGNvbnN0IHN0YXR1cyBvZiBPYmplY3Qua2V5cyhcclxuXHRcdFx0XHRzZXR0aW5nVGFiLnBsdWdpbi5zZXR0aW5ncy50YXNrU3RhdHVzZXNcclxuXHRcdFx0KSkge1xyXG5cdFx0XHRcdGNvbnN0IGljb25FbCA9IGVsLmNyZWF0ZVNwYW4oKTtcclxuXHRcdFx0XHRzZXRJY29uKFxyXG5cdFx0XHRcdFx0aWNvbkVsLFxyXG5cdFx0XHRcdFx0c3RhdHVzIGFzXHJcblx0XHRcdFx0XHRcdHwgXCJub3RTdGFydGVkXCJcclxuXHRcdFx0XHRcdFx0fCBcImluUHJvZ3Jlc3NcIlxyXG5cdFx0XHRcdFx0XHR8IFwiY29tcGxldGVkXCJcclxuXHRcdFx0XHRcdFx0fCBcImFiYW5kb25lZFwiXHJcblx0XHRcdFx0XHRcdHwgXCJwbGFubmVkXCJcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNvbnN0IHRnSWNvbkVsID0gZWwuY3JlYXRlU3BhbigpO1xyXG5cdFx0XHRzZXRJY29uKHRnSWNvbkVsLCBcInRhc2stZ2VuaXVzXCIpO1xyXG5cdFx0fVxyXG5cdCk7XHJcbn1cclxuIl19