# 任务内联编辑功能

## 功能概述

本功能为任务列表项和树形视图项添加了实时编辑能力，用户可以直接在任务视图中编辑任务内容和元数据，无需打开单独的编辑界面。

## 主要特性

### 1. 内容编辑
- **点击任务内容**：直接点击任务的文本内容即可进入编辑模式
- **自动保存**：输入时自动保存，支持防抖处理
- **快捷键支持**：
  - `Enter`：保存并退出编辑
  - `Shift + Enter`：换行
  - `Escape`：取消编辑并恢复原内容

### 2. 元数据编辑
- **点击元数据项**：点击日期、项目、标签等元数据项即可编辑
- **支持的元数据类型**：
  - 截止日期 (Due Date)
  - 开始日期 (Start Date)
  - 计划日期 (Scheduled Date)
  - 项目 (Project)
  - 标签 (Tags)
  - 上下文 (Context)
  - 优先级 (Priority)
  - 重复规则 (Recurrence)

### 3. 新增元数据
- **加号按钮**：在元数据区域末尾显示加号按钮
- **菜单选择**：点击加号按钮显示可添加的元数据类型菜单
- **动态添加**：选择元数据类型后立即显示对应的编辑器

### 4. 自动完成支持
- **项目建议**：项目输入框支持现有项目的自动完成
- **标签建议**：标签输入框支持现有标签的自动完成
- **上下文建议**：上下文输入框支持现有上下文的自动完成

## 技术实现

### 核心组件

#### InlineEditor
- 位置：`src/components/task-view/InlineEditor.ts`
- 功能：提供内联编辑的核心逻辑
- 特性：
  - 支持多种元数据类型的编辑
  - 防抖保存机制
  - 错误处理和回滚

#### 更新的组件
- `TaskListItemComponent`：列表视图任务项
- `TaskTreeItemComponent`：树形视图任务项
- `TaskListRendererComponent`：任务列表渲染器
- `ContentComponent`：内容组件
- `TaskView`：主任务视图

### 样式文件
- `src/styles/inline-editor.css`：内联编辑器的样式定义

## 使用方法

### 编辑任务内容
1. 在任务列表或树形视图中找到要编辑的任务
2. 点击任务的文本内容部分
3. 在弹出的文本框中编辑内容
4. 按 `Enter` 保存或按 `Escape` 取消

### 编辑元数据
1. 将鼠标悬停在元数据项上（会显示"Click to edit"提示）
2. 点击要编辑的元数据项
3. 在弹出的编辑器中修改值
4. 按 `Enter` 保存或按 `Escape` 取消

### 添加新元数据
1. 在任务的元数据区域找到加号按钮
2. 点击加号按钮
3. 从菜单中选择要添加的元数据类型
4. 在弹出的编辑器中输入值
5. 按 `Enter` 保存

## 注意事项

1. **编辑状态指示**：编辑时会显示明显的视觉反馈
2. **自动保存**：输入会自动保存，无需手动保存操作
3. **错误处理**：如果保存失败，会自动回滚到原始值
4. **性能优化**：使用防抖机制避免频繁保存
5. **响应式设计**：在移动设备上自动调整布局

## 快捷键总结

| 快捷键 | 功能 |
|--------|------|
| `Enter` | 保存并退出编辑 |
| `Shift + Enter` | 换行（仅内容编辑） |
| `Escape` | 取消编辑并恢复原值 |

## 兼容性

- 支持所有现有的任务格式
- 兼容 Dataview 和 Emoji 元数据格式
- 支持桌面和移动设备
- 与现有的任务管理功能完全兼容 
